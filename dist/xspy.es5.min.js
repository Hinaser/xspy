!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.xspy=i():t.xspy=i()}(window,(function(){return function(t){var i={};function n(e){if(i[e])return i[e].exports;var r=i[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=i,n.d=function(t,i,e){n.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"h",{value:!0})},n.t=function(t,i){if(1&i&&(t=n(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.h)return t;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var r in t)n.d(e,r,function(i){return t[i]}.bind(null,r));return e},n.n=function(t){var i=t&&t.h?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},n.p="",n(n.s=0)}([function(t,i,n){"use strict";n.r(i);var e,r,s=(window.fetch||function(){}).bind(window),h=function(){function t(){}return t.enable=function(){window.XMLHttpRequest=t.u,window.fetch&&(window.fetch=t.v)},t.disable=function(){window.XMLHttpRequest=t.OriginalXHR,window.fetch&&t.OriginalFetch&&(window.fetch=t.OriginalFetch)},t.isEnabled=function(){return window.XMLHttpRequest===t.u},t.setXMLHttpRequest=function(i){t.u=i},t.setFetch=function(i){t.v=i},t.getRequestListeners=function(){return t.g.slice()},t.getResponseListeners=function(){return t.j.slice()},t.onRequest=function(t,i){var n=this.g;n.indexOf(t)>-1||("number"==typeof i?n.splice(i,0,t):n.push(t))},t.offRequest=function(t){this.O("request",t)},t.onResponse=function(t,i){var n=this.j;n.indexOf(t)>-1||("number"==typeof i?n.splice(i,0,t):n.push(t))},t.offResponse=function(t){this.O("response",t)},t.clearAll=function(){t.clearRequestHandler(),t.clearResponseHandler()},t.clearRequestHandler=function(){this.g=[]},t.clearResponseHandler=function(){this.j=[]},t.O=function(t,i){for(var n="request"===t?this.g:this.j,e=0;e<n.length;e++)if(n[e]===i)return void n.splice(e,1)},t.g=[],t.j=[],t.u=window.XMLHttpRequest,t.v=window.fetch,t.OriginalXHR=window.XMLHttpRequest,t.OriginalFetch=s,t}(),o=Date.now(),u=function(){function t(t,i){this.T=!1,this.M=!1,this.q=!1,this.L=!1,this.R=!1,this.H=[],this.X=0,this.P=!0,this.D="",this.N=null,this.S=null,this._=null,this.A=!0,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.I=Date.now()-o,this.D=t,this.T=i.bubbles,this.H=i.path,this.X=i.eventPhase,this.N=i.target,this.S=i.target,this._=i.target}return Object.defineProperty(t.prototype,"bubbles",{get:function(){return this.T},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cancelBubble",{get:function(){return this.M},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cancelable",{get:function(){return this.q},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"composed",{get:function(){return this.L},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultPrevented",{get:function(){return this.R},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"eventPhase",{get:function(){return this.X},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"returnValue",{get:function(){return this.P},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"timeStamp",{get:function(){return this.I},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.D},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentTarget",{get:function(){return this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"srcElement",{get:function(){return this._},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isTrusted",{get:function(){return this.A},enumerable:!1,configurable:!0}),t.prototype.composedPath=function(){return this.H},t.prototype.initEvent=function(t,i,n){this.D=t,void 0!==i&&(this.T=i),void 0!==n&&(this.q=n)},t.prototype.preventDefault=function(){},t.prototype.stopImmediatePropagation=function(){this.M=!0},t.prototype.stopPropagation=function(){},t}(),f=(e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n])})(t,i)},function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),c=function(t){function i(i,n){var e=t.call(this,i,n)||this;return e.k=!0,e.U=0,e.C=0,e.k=n.lengthComputable,e.U=n.loaded,e.C=n.total,e}return f(i,t),Object.defineProperty(i.prototype,"lengthComputable",{get:function(){return this.k},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"loaded",{get:function(){return this.U},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"total",{get:function(){return this.C},enumerable:!1,configurable:!0}),i}(u),a="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:"",l=(r=parseInt((/msie (\d+)/.exec(a.toLowerCase())||[])[1],10),isNaN(r)?(r=parseInt((/trident\/.*; rv:(\d+)/.exec(a.toLowerCase())||[])[1],10),!isNaN(r)&&r):r);function b(t,i){return!1!==l&&(!i||("<"===t?l<i:"<="===t?l<=i:">"===t?l>i:">="===t?l>=i:l===i))}var v=function(t,i,n,e,r,s){var h={target:i,bubbles:n,path:[i],eventPhase:Event.AT_TARGET,lengthComputable:e,loaded:r,total:s};return new c(t,h)},d=function(){return(d=Object.assign||function(t){for(var i,n=1,e=arguments.length;n<e;n++)for(var r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},p=function(){function t(){this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.B=new h.OriginalXHR,this.G={},this.V=0,this.F=!1,this.J=null,this.K=null,this.W=t.Y(this.B),this.Z=t.$(),this.tt="",this.it=null,this.k=!1,this.U=0,this.C=0,this.readyState=0,this.status=0,this.statusText="",this.timeout=0,this.upload=this.B.upload,this.response="",this.responseType="",this.responseURL="",this.withCredentials=!1,this.onreadystatechange=null,this.onabort=null,this.onerror=null,this.onloadstart=null,this.onload=null,this.onloadend=null,this.ontimeout=null,this.onprogress=null,this.nt()}return Object.defineProperty(t.prototype,"responseText",{get:function(){if("text"===this.responseType||""===this.responseType)return this.tt;if(b(">=",10))return this.tt;var t=new Error("responseText is only available if responseType is '' or 'text'.");throw t.name="InvalidStateError",t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"responseXML",{get:function(){if("document"===this.responseType||""===this.responseType)return this.it;if(b(">=",10))return this.it;var t=new Error("responseXML is only available if responseType is '' or 'document'.");throw t.name="InvalidStateError",t},enumerable:!1,configurable:!0}),t.prototype.nt=function(){var t=this;this.et=this.et.bind(this),this.rt=this.rt.bind(this),this.st=this.st.bind(this);var i=function(i){t.addEventListener(i,t.et)};i("error"),i("timeout"),i("abort"),this.B.onreadystatechange=function(){var i=t.B.readyState;i===t.HEADERS_RECEIVED?b("<=",9)&&!1===t.W.async||t.ht():i===t.LOADING?t.ht():i===t.DONE&&(t.K=!1,t.ht(),t.ot()),t.ut(i)},this.B.addEventListener("progress",this.st),this.B.addEventListener("load",this.st)},t.prototype.addEventListener=function(t,i,n){this.G[t]||(this.G[t]=[]),this.G[t].push(i)},t.prototype.removeEventListener=function(t,i,n){if(this.G[t]){var e=this.G[t].indexOf(i);e<0||this.G[t].splice(e,1)}},t.prototype.dispatchEvent=function(t){if("object"!=typeof t)throw new TypeError("EventTarget.dispatchEvent: Argument 1 is not an object");var i="on"+t.type;if("onabort"===i||"onerror"===i||"onload"===i||"onloadend"===i||"onloadstart"===i||"onprogress"===i||"ontimeout"===i)(n=this[i])&&n.call(this,t);else if("onreadystatechange"===i){var n;(n=this[i])&&n.call(this,t)}var e=this.G[t.type];if(!e)return!0;for(var r=0;r<e.length&&!t.cancelBubble;r++){e[r].call(this,t)}return!0},t.prototype.overrideMimeType=function(t){return this.B.overrideMimeType.call(this.B,t)},t.prototype.open=function(i,n,e,r,s){if(arguments.length<2)throw new TypeError("XMLHttpRequest.open: "+arguments.length+" is not a valid argument count for any overload");this.V=0,this.J=!1,this.F=!1,this.K=!1,this.W=d(d({},t.Y(this.B)),{headers:{},method:i,url:n,async:!1!==e,username:r,password:s}),this.Z=d(d({},t.$()),{headers:{}}),this.ut(this.OPENED)},t.prototype.send=function(t){var i=this;if(this.V!==this.OPENED)throw new DOMException("XMLHttpRequest state must be OPENED");this.ft(t),this.ct();var n=!1,e=h.getRequestListeners(),r=0,s=function(){try{if(r>=e.length)return function(){if(n=!0,i.V!==i.DONE){i.K=!0;var t=!1!==i.W.async;i.B.open(i.W.method,i.W.url,t,i.W.username,i.W.password),t&&(i.B.responseType=i.responseType,i.B.timeout=i.timeout),i.B.withCredentials=i.withCredentials,i.dispatchEvent(v("loadstart",i,!1,!1,0,0));for(var e=i.W.headers,r=e?Object.keys(e):[],s=0;s<r.length;s++){var h=r[s],o=e[h];i.B.setRequestHeader(h,o)}i.B.send(i.W.body)}}();var t=e[r];if(t.length>=2){var h=i.rt((function(){r++,s()}));return void t.call(i,i.W,h)}t.call(i,i.W),r++,s()}catch(t){console.warn("XMLHttpRequest: Exception in request handler",t),n||(r++,s())}};s()},t.prototype.setRequestHeader=function(t,i){if(this.readyState!==this.OPENED)throw new DOMException("XMLHttpRequest state must be OPENED");this.W.headers||(this.W.headers={});var n=t.toLowerCase();this.W.headers[n]&&(i=this.W.headers[n]+", "+i),this.W.headers[n]=i},t.prototype.getResponseHeader=function(t){var i=t.toLowerCase();if(this.readyState<this.HEADERS_RECEIVED||!(i in this.Z.headers)){if(b("<=",9)){if(this.readyState<this.OPENED)throw new Error;return""}return null}return this.Z.headers[i]},t.prototype.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED){if(b("<=",9)&&this.readyState<this.OPENED)throw new Error;return""}return function(t){for(var i=[],n=Object.keys(t),e=0;e<n.length;e++){var r=n[e],s=r.toLowerCase(),h=t[r];i.push(s+": "+h)}return i.join("\r\n")+"\r\n"}(this.Z.headers)},t.prototype.abort=function(){this.F=!0,this.status=0,this.readyState=this.UNSENT,this.V=this.UNSENT,this.K?this.B.abort():this.dispatchEvent(v("abort",this,b("=",11),!0,0,0)),this.K=!1},t.Y=function(t){return{ajaxType:"xhr",headers:{},method:"GET",url:"",async:!0,timeout:0,upload:t.upload}},t.$=function(){return{ajaxType:"xhr",status:0,statusText:"",finalUrl:"",responseType:"",headers:{}}},t.prototype.ft=function(t){this.W.responseType=this.responseType,this.W.timeout=this.timeout,this.W.withCredentials=this.withCredentials,this.W.body=t,this.B.onabort="function"==typeof this.onabort?this.onabort.bind(this):null,this.B.onerror="function"==typeof this.onerror?this.onerror.bind(this):null,this.B.ontimeout="function"==typeof this.ontimeout?this.ontimeout.bind(this):null,this.B.onprogress="function"==typeof this.onprogress?this.onprogress.bind(this):null},t.prototype.ct=function(){var t=this,i=function(i){var n=t.G[i];if(n&&!(n.length<1))for(var e=0;e<n.length;e++)t.B.addEventListener(i,n[e].bind(t))};i("abort"),i("error"),i("timeout"),i("progress")},t.prototype.rt=function(t){var i=this,n=function(n){n&&"object"==typeof n?(i.dispatchEvent(v("loadstart",i,!1,!1,0,0)),i.Z=d(d({},i.Z),n),i.ut(i.DONE),t()):t()};return n.moveToHeaderReceived=function(t){i.readyState>=i.HEADERS_RECEIVED||(i.Z=d(d({},i.Z),t),i.ut(i.HEADERS_RECEIVED))},n.moveToLoading=function(t){i.readyState>=i.LOADING||(i.Z=d(d({},i.Z),t),i.ut(i.LOADING))},n},t.prototype.at=function(t){var i=this;return function(n){n&&"object"==typeof n?(i.Z=d(d({},i.Z),n),t()):t()}},t.prototype.ht=function(){if(this.Z.status=this.B.status,!this.F){this.Z.statusText=this.B.statusText;for(var t=function(t){for(var i=t.trim().split(/[\r\n]+/),n={},e=0;e<i.length;e++){var r=i[e].split(": "),s=r.shift();s&&(n[s.toLowerCase()]=r.join(": "))}return n}(this.B.getAllResponseHeaders()),i=Object.keys(t),n=0;n<i.length;n++){var e=i[n],r=t[e];this.Z.headers[e]||(this.Z.headers[e]=r)}}},t.prototype.ot=function(){this.B.responseType?"text"===this.B.responseType?(this.Z.responseText=this.B.responseText,this.Z.response=this.B.responseText):"document"===this.B.responseType?(this.Z.responseXML=this.B.responseXML,this.Z.response=this.B.responseXML):this.Z.response=this.B.response:(this.Z.responseText=this.B.responseText,this.Z.responseXML=this.B.responseXML,this.Z.response=this.B.responseText),"responseURL"in this.B&&(this.Z.responseURL=this.B.responseURL)},t.prototype.st=function(t){this.k=t.lengthComputable,this.U=t.loaded,this.C=t.total},t.prototype.lt=function(){this.status=this.Z.status,this.statusText=this.Z.statusText},t.prototype.bt=function(){"responseText"in this.Z&&(this.tt=this.Z.responseText||""),"responseXML"in this.Z&&(this.it=this.Z.responseXML||null),"body"in this.Z&&(this.response=this.Z.body||null),"response"in this.Z&&(this.response=this.Z.response),"responseURL"in this.Z&&(this.responseURL=this.Z.responseURL||"")},t.prototype.et=function(){this.J=!0,this.V=this.UNSENT,this.readyState=this.UNSENT,this.status=0},t.prototype.vt=function(){var t,i,n,e,r=this,s=(t="readystatechange",i=this,n=b("=",11),e={target:i,bubbles:n,path:[i],eventPhase:Event.AT_TARGET},new u(t,e));if(this.V===this.OPENED)this.dispatchEvent(s);else if(this.V===this.HEADERS_RECEIVED)this.lt(),this.dispatchEvent(s);else if(this.V===this.LOADING)this.lt(),this.dispatchEvent(s);else if(this.V===this.DONE){this.lt(),this.bt();var o=!1,f=h.getResponseListeners(),c=0,a=function(){try{if(c>=f.length)return function(){o=!0,r.lt(),r.bt(),r.dispatchEvent(s);var t=function(){r.J||r.dispatchEvent(v("load",r,!1,r.k,r.U,r.C)),r.dispatchEvent(v("loadend",r,!1,r.k,r.U,r.C))};!1===r.W.async?t():window.setTimeout(t,0)}();var t=f[c];if(t.length>=3){var i=r.at((function(){c++,a()}));return void t.call(r,r.W,r.Z,i)}t.call(r,r.W,r.Z),c++,a()}catch(t){console.warn("XMLHttpRequest: Exception in response handler",t),o||(c++,a())}};a()}},t.prototype.ut=function(t){for(;this.V<t&&this.V<this.DONE;)this.V++,this.readyState=this.V,this.vt()},t.UNSENT=0,t.OPENED=1,t.HEADERS_RECEIVED=2,t.LOADING=3,t.DONE=4,t}(),g=function(){function t(t,i){this.Z=new Response(t,i),this.dt=t,this.nt=i,this.headers=new Headers(i?i.headers:void 0),this.ok=!1,this.redirected=!1,this.status=i&&i.status?i.status:0,this.statusText=i&&i.statusText?i.statusText:"",this.trailer=this.Z.trailer,this.type="basic",this.url="",this.body=this.Z.body,this.bodyUsed=this.Z.bodyUsed}return t.error=function(){return Response.error()},t.redirect=function(t,i){return Response.redirect(t,i)},t.prototype.clone=function(){return new t(this.dt,this.nt)},t.prototype.arrayBuffer=function(){return this.Z.arrayBuffer()},t.prototype.blob=function(){return this.Z.blob()},t.prototype.formData=function(){return this.Z.formData()},t.prototype.json=function(){return this.Z.json()},t.prototype.text=function(){return this.Z.text()},t}(),w=function(){return(w=Object.assign||function(t){for(var i,n=1,e=arguments.length;n<e;n++)for(var r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},y=function(){function t(i,n){this.pt=i,this.nt=n,this.dispatch=this.dispatch.bind(this),this.gt=this.gt.bind(this),this.rt=this.rt.bind(this),this.at=this.at.bind(this),this.W=t.Y(i,n),this.Z=t.$()}return t.prototype.dispatch=function(){var t=this;return new Promise((function(i,n){var e=t.Z,r=!1,s=h.getRequestListeners(),o=0,u=function(){try{if(o>=s.length)return r=!0,void(e===t.Z?h.OriginalFetch(t.W.url,t.W).then((function(n){for(var e={},r=0,s=n.headers.keys();r<s.length;r++){var h=s[r],o=n.headers.get(h);o&&(e[h]=o)}t.Z={ajaxType:"fetch",status:n.status,statusText:n.statusText,headers:e,ok:n.ok,redirected:n.redirected,type:n.type,url:n.url,body:n.body},t.gt().then((function(t){i(t)}))})):t.gt().then((function(t){i(t)})));var n=s[o];if(n.length>=2){var f=t.rt((function(){o++,u()}));return void n.call({},t.W,f)}n.call({},t.W),o++,u()}catch(t){console.warn("XMLHttpRequest: Exception in request handler",t),r||(o++,u())}};u()}))},t.prototype.gt=function(){var t=this;return new Promise((function(i){var n=!1,e=h.getResponseListeners(),r=0,s=function(){try{if(r>=e.length)return function(){n=!0;var e=new g(t.Z.body,t.Z);e.url=t.Z.url,e.type=t.Z.type,e.redirected=t.Z.redirected,e.ok=t.Z.ok,i(e)}();var h=e[r];if(h.length>=3){var o=t.at((function(){r++,s()}));return void h.call({},t.W,t.Z,o)}h.call({},t.W,t.Z),r++,s()}catch(t){console.warn("XMLHttpRequest: Exception in request handler",t),n||(r++,s())}};s()}))},t.Y=function(t,i){if("string"==typeof t){var n=w(w({},i||{}),{ajaxType:"fetch",headers:{},url:t});if(i&&i.headers)for(var e=i.headers instanceof Headers?i.headers:new Headers(i.headers),r=Array.from(e.entries()),s=0;s<r.length;s++){var h=(o=r[s])[0];(u=o[1])&&(n.headers[h]=u)}return n}e=t.headers||(i&&i.headers?i.headers:null),n=w(w({},i||{}),{ajaxType:"fetch",method:t.method,url:t.url,timeout:0,headers:{},body:t.body,cache:t.cache,credentials:t.credentials,integrity:t.integrity,keepalive:t.keepalive,mode:t.mode,redirect:t.redirect,referrer:t.referrer,referrerPolicy:t.referrerPolicy,signal:t.signal});if(e)for(r=Array.from(e.entries()),s=0;s<r.length;s++){var o,u;h=(o=r[s])[0];(u=o[1])&&(n.headers[h]=u)}return n},t.$=function(){return{ajaxType:"fetch",status:0,statusText:"",headers:{},ok:!0,redirected:!1,type:"basic",url:"",body:null}},t.prototype.rt=function(t){var i=this,n=function(n){n&&"object"==typeof n?(i.Z=n,t()):t()};return n.moveToHeaderReceived=function(){},n.moveToLoading=function(){},n},t.prototype.at=function(t){var i=this;return function(n){n&&"object"==typeof n?(i.Z=n,t()):t()}},t}();h.setXMLHttpRequest(p),h.setFetch((function(t,i){return new y(t,i).dispatch()})),h.enable();i.default=h}]).default}));
//# sourceMappingURL=xspy.es5.min.js.map