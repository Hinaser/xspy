!function(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.xspy=i():t.xspy=i()}(window,(function(){return function(t){var i={};function n(r){if(i[r])return i[r].exports;var e=i[r]={i:r,l:!1,exports:{}};return t[r].call(e.exports,e,e.exports,n),e.l=!0,e.exports}return n.m=t,n.c=i,n.d=function(t,i,r){n.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"h",{value:!0})},n.t=function(t,i){if(1&i&&(t=n(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.h)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var e in t)n.d(r,e,function(i){return t[i]}.bind(null,e));return r},n.n=function(t){var i=t&&t.h?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},n.p="",n(n.s=0)}([function(t,i,n){"use strict";n.r(i);var r,e=function(){function t(){}return t.enable=function(){window.XMLHttpRequest=t.u,window.fetch&&(window.fetch=t.v)},t.disable=function(){window.XMLHttpRequest=t.OriginalXHR,window.fetch&&t.OriginalFetch&&(window.fetch=t.OriginalFetch)},t.isEnabled=function(){return window.XMLHttpRequest===t.u},t.setXMLHttpRequest=function(i){t.u=i},t.setFetch=function(i){t.v=i},t.getRequestListeners=function(){return t.j.slice()},t.getResponseListeners=function(){return t.g.slice()},t.onRequest=function(t,i){var n=this.j;n.indexOf(t)>-1||("number"==typeof i?n.splice(i,0,t):n.push(t))},t.offRequest=function(t){this.O("request",t)},t.onResponse=function(t,i){var n=this.g;n.indexOf(t)>-1||("number"==typeof i?n.splice(i,0,t):n.push(t))},t.offResponse=function(t){this.O("response",t)},t.clearAll=function(){t.clearRequestHandler(),t.clearResponseHandler()},t.clearRequestHandler=function(){this.j=[]},t.clearResponseHandler=function(){this.g=[]},t.O=function(t,i){for(var n="request"===t?this.j:this.g,r=0;r<n.length;r++)if(n[r]===i)return void n.splice(r,1)},t.j=[],t.g=[],t.u=window.XMLHttpRequest,t.v=window.fetch,t.OriginalXHR=window.XMLHttpRequest,t.OriginalFetch=(window.fetch||function(){}).bind(window),t}(),s=function(){return(s=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)},o="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:"",h=(r=parseInt((/msie (\d+)/.exec(o.toLowerCase())||[])[1],10),isNaN(r)?(r=parseInt((/trident\/.*; rv:(\d+)/.exec(o.toLowerCase())||[])[1],10),!isNaN(r)&&r):r);function u(t,i){return!1!==h&&(!i||("<"===t?h<i:"<="===t?h<=i:">"===t?h>i:">="===t?h>=i:h===i))}var f=function(t){try{if(!u()&&"undefined"!=typeof Event)return new Event(t);var i=window.document.createEvent("Event");return i.initEvent(t),i}catch(i){return{type:t}}},c=function(t,i,n,r){return void 0===n&&(n=!1),void 0===r&&(r=0),s(s({},f(t)),{type:t,target:null,loaded:i,lengthComputable:n,total:r})},a=function(){return(a=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)},l=function(){function t(){this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.T=new e.OriginalXHR,this.M={},this.q=0,this.L=!1,this.R=null,this.H=null,this.X=t.N(this.T),this.P=t.S(),this.D="",this.I=null,this.readyState=0,this.status=0,this.statusText="",this.timeout=0,this.upload=this.T.upload,this.response="",this.responseType="",this.responseURL="",this.withCredentials=!1,this.onreadystatechange=null,this.onabort=null,this.onerror=null,this.onloadstart=null,this.onload=null,this.onloadend=null,this.ontimeout=null,this.onprogress=null,this.k()}return Object.defineProperty(t.prototype,"responseText",{get:function(){if("text"===this.responseType||""===this.responseType)return this.D;if(u(">=",10))return this.D;var t=new Error("responseText is only available if responseType is '' or 'text'.");throw t.name="InvalidStateError",t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"responseXML",{get:function(){if("document"===this.responseType||""===this.responseType)return this.I;if(u(">=",10))return this.I;var t=new Error("responseXML is only available if responseType is '' or 'document'.");throw t.name="InvalidStateError",t},enumerable:!1,configurable:!0}),t.prototype.k=function(){var t=this;this.A=this.A.bind(this),this.U=this.U.bind(this);var i=function(i){t.addEventListener(i,t.A)};i("error"),i("timeout"),i("abort"),this.T.onreadystatechange=function(){var i=t.T.readyState;i===t.HEADERS_RECEIVED?u("<=",9)&&!1===t.X.async||t._():i===t.LOADING?t._():i===t.DONE&&(t.H=!1,t._(),t.C()),t.G(i)}},t.prototype.addEventListener=function(t,i,n){this.M[t]||(this.M[t]=[]),this.M[t].push(i)},t.prototype.removeEventListener=function(t,i,n){if(this.M[t]){var r=this.M[t].indexOf(i);r<0||this.M[t].splice(r,1)}},t.prototype.dispatchEvent=function(t){if("object"!=typeof t)throw new TypeError("EventTarget.dispatchEvent: Argument 1 is not an object");var i="on"+t.type;if("onabort"===i||"onerror"===i||"onload"===i||"onloadend"===i||"onloadstart"===i||"onprogress"===i||"ontimeout"===i)(n=this[i])&&n.call(this,t);else if("onreadystatechange"===i){var n;(n=this[i])&&n.call(this,t)}var r=this.M[t.type];if(!r)return!0;for(var e=0;e<r.length;e++){r[e].call(this,t)}return!0},t.prototype.overrideMimeType=function(t){return this.T.overrideMimeType.call(this.T,t)},t.prototype.open=function(i,n,r,e,s){if(arguments.length<2)throw new TypeError("XMLHttpRequest.open: "+arguments.length+" is not a valid argument count for any overload");this.q=0,this.R=!1,this.L=!1,this.H=!1,this.X=a(a({},t.N(this.T)),{headers:{},method:i,url:n,async:!1!==r,username:e,password:s}),this.P=a(a({},t.S()),{headers:{}}),this.G(this.OPENED)},t.prototype.send=function(t){var i=this;if(this.q!==this.OPENED)throw new DOMException("XMLHttpRequest state must be OPENED");this.B(t),this.F();var n=!1,r=e.getRequestListeners(),s=0,o=function(){try{if(s>=r.length)return function(){if(n=!0,i.q!==i.DONE){i.H=!0;var t=!1!==i.X.async;i.T.open(i.X.method,i.X.url,t,i.X.username,i.X.password),t&&(i.T.responseType=i.responseType,i.T.timeout=i.timeout),i.T.withCredentials=i.withCredentials,i.dispatchEvent(c("loadstart",0));for(var r=i.X.headers,e=r?Object.keys(r):[],s=0;s<e.length;s++){var o=e[s],h=r[o];i.T.setRequestHeader(o,h)}i.T.send(i.X.body)}}();var t=r[s];if(t.length>=2){var e=i.U((function(){s++,o()}));return void t.call(i,i.X,e)}t.call(i,i.X),s++,o()}catch(t){console.warn("XMLHttpRequest: Exception in request handler",t),n||(s++,o())}};o()},t.prototype.setRequestHeader=function(t,i){if(this.readyState!==this.OPENED)throw new DOMException("XMLHttpRequest state must be OPENED");this.X.headers||(this.X.headers={});var n=t.toLowerCase();this.X.headers[n]&&(i=this.X.headers[n]+", "+i),this.X.headers[n]=i},t.prototype.getResponseHeader=function(t){var i=t.toLowerCase();if(this.readyState<this.HEADERS_RECEIVED||!(i in this.P.headers)){if(u("<=",9)){if(this.readyState<this.OPENED)throw new Error;return""}return null}return this.P.headers[i]},t.prototype.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED){if(u("<=",9)&&this.readyState<this.OPENED)throw new Error;return""}return function(t){for(var i=[],n=Object.keys(t),r=0;r<n.length;r++){var e=n[r],s=e.toLowerCase(),o=t[e];i.push(s+": "+o)}return i.join("\r\n")+"\r\n"}(this.P.headers)},t.prototype.abort=function(){this.L=!0,this.status=0,this.readyState=this.UNSENT,this.q=this.UNSENT,this.H?this.T.abort():this.dispatchEvent(c("abort",0)),this.H=!1},t.N=function(t){return{ajaxType:"xhr",headers:{},method:"GET",url:"",async:!0,timeout:0,upload:t.upload}},t.S=function(){return{ajaxType:"xhr",status:0,statusText:"",finalUrl:"",responseType:"",headers:{}}},t.prototype.B=function(t){this.X.responseType=this.responseType,this.X.timeout=this.timeout,this.X.withCredentials=this.withCredentials,this.X.body=t,this.T.onabort="function"==typeof this.onabort?this.onabort.bind(this):null,this.T.onerror="function"==typeof this.onerror?this.onerror.bind(this):null,this.T.ontimeout="function"==typeof this.ontimeout?this.ontimeout.bind(this):null,this.T.onprogress="function"==typeof this.onprogress?this.onprogress.bind(this):null},t.prototype.F=function(){var t=this,i=function(i){var n=t.M[i];if(n&&!(n.length<1))for(var r=0;r<n.length;r++)t.T.addEventListener(i,n[r].bind(t))};i("abort"),i("error"),i("timeout"),i("progress")},t.prototype.U=function(t){var i=this,n=function(n){n&&"object"==typeof n?(i.dispatchEvent(c("loadstart",0)),i.P=a(a({},i.P),n),i.G(i.DONE),t()):t()};return n.moveToHeaderReceived=function(t){i.readyState>=i.HEADERS_RECEIVED||(i.P=a(a({},i.P),t),i.G(i.HEADERS_RECEIVED))},n.moveToLoading=function(t){i.readyState>=i.LOADING||(i.P=a(a({},i.P),t),i.G(i.LOADING))},n},t.prototype.J=function(t){var i=this;return function(n){n&&"object"==typeof n?(i.P=a(a({},i.P),n),t()):t()}},t.prototype._=function(){if(this.P.status=this.T.status,!this.L){this.P.statusText=this.T.statusText;for(var t=function(t){for(var i=t.trim().split(/[\r\n]+/),n={},r=0;r<i.length;r++){var e=i[r].split(": "),s=e.shift();s&&(n[s.toLowerCase()]=e.join(": "))}return n}(this.T.getAllResponseHeaders()),i=Object.keys(t),n=0;n<i.length;n++){var r=i[n],e=t[r];this.P.headers[r]||(this.P.headers[r]=e)}}},t.prototype.C=function(){this.T.responseType?"text"===this.T.responseType?(this.P.responseText=this.T.responseText,this.P.response=this.T.responseText):"document"===this.T.responseType?(this.P.responseXML=this.T.responseXML,this.P.response=this.T.responseXML):this.P.response=this.T.response:(this.P.responseText=this.T.responseText,this.P.responseXML=this.T.responseXML,this.P.response=this.T.responseText),"responseURL"in this.T&&(this.P.responseURL=this.T.responseURL)},t.prototype.K=function(){this.status=this.P.status,this.statusText=this.P.statusText},t.prototype.V=function(){"responseText"in this.P&&(this.D=this.P.responseText||""),"responseXML"in this.P&&(this.I=this.P.responseXML||null),"body"in this.P&&(this.response=this.P.body||null),"response"in this.P&&(this.response=this.P.response),"responseURL"in this.P&&(this.responseURL=this.P.responseURL||"")},t.prototype.A=function(){this.R=!0,this.q=this.UNSENT,this.readyState=this.UNSENT,this.status=0},t.prototype.W=function(){var t=this,i=f("readystatechange");if(this.q===this.OPENED)this.dispatchEvent(i);else if(this.q===this.HEADERS_RECEIVED)this.K(),this.dispatchEvent(i);else if(this.q===this.LOADING)this.K(),this.dispatchEvent(i);else if(this.q===this.DONE){this.K(),this.V();var n=!1,r=e.getResponseListeners(),s=0,o=function(){try{if(s>=r.length)return function(){n=!0,t.K(),t.V(),t.dispatchEvent(i);var r=function(){t.R||t.dispatchEvent(c("load",0)),t.dispatchEvent(c("loadend",0))};!1===t.X.async?r():window.setTimeout(r,0)}();var e=r[s];if(e.length>=3){var h=t.J((function(){s++,o()}));return void e.call(t,t.X,t.P,h)}e.call(t,t.X,t.P),s++,o()}catch(t){console.warn("XMLHttpRequest: Exception in response handler",t),n||(s++,o())}};o()}},t.prototype.G=function(t){for(;this.q<t&&this.q<this.DONE;)this.q++,this.readyState=this.q,this.W()},t.UNSENT=0,t.OPENED=1,t.HEADERS_RECEIVED=2,t.LOADING=3,t.DONE=4,t}(),v=function(){function t(t,i){this.P=new Response(t,i),this.Y=t,this.k=i,this.headers=new Headers(i?i.headers:void 0),this.ok=!1,this.redirected=!1,this.status=i&&i.status?i.status:0,this.statusText=i&&i.statusText?i.statusText:"",this.trailer=this.P.trailer,this.type="basic",this.url="",this.body=this.P.body,this.bodyUsed=this.P.bodyUsed}return t.error=function(){return Response.error()},t.redirect=function(t,i){return Response.redirect(t,i)},t.prototype.clone=function(){return new t(this.Y,this.k)},t.prototype.arrayBuffer=function(){return this.P.arrayBuffer()},t.prototype.blob=function(){return this.P.blob()},t.prototype.formData=function(){return this.P.formData()},t.prototype.json=function(){return this.P.json()},t.prototype.text=function(){return this.P.text()},t}(),d=function(){return(d=Object.assign||function(t){for(var i,n=1,r=arguments.length;n<r;n++)for(var e in i=arguments[n])Object.prototype.hasOwnProperty.call(i,e)&&(t[e]=i[e]);return t}).apply(this,arguments)},p=function(){function t(i,n){this.Z=i,this.k=n,this.dispatch=this.dispatch.bind(this),this.$=this.$.bind(this),this.U=this.U.bind(this),this.J=this.J.bind(this),this.X=t.N(i,n),this.P=t.S()}return t.prototype.dispatch=function(){var t=this;return new Promise((function(i,n){var r=t.P,s=!1,o=e.getRequestListeners(),h=0,u=function(){try{if(h>=o.length)return s=!0,void(r===t.P?e.OriginalFetch(t.X.url,t.X).then((function(n){for(var r={},e=0,s=n.headers.keys();e<s.length;e++){var o=s[e],h=n.headers.get(o);h&&(r[o]=h)}t.P={ajaxType:"fetch",status:n.status,statusText:n.statusText,headers:r,ok:n.ok,redirected:n.redirected,type:n.type,url:n.url,body:n.body},t.$().then((function(t){i(t)}))})):t.$().then((function(t){i(t)})));var n=o[h];if(n.length>=2){var f=t.U((function(){h++,u()}));return void n.call({},t.X,f)}n.call({},t.X),h++,u()}catch(t){console.warn("XMLHttpRequest: Exception in request handler",t),s||(h++,u())}};u()}))},t.prototype.$=function(){var t=this;return new Promise((function(i){var n=!1,r=e.getResponseListeners(),s=0,o=function(){try{if(s>=r.length)return function(){n=!0;var r=new v(t.P.body,t.P);r.url=t.P.url,r.type=t.P.type,r.redirected=t.P.redirected,r.ok=t.P.ok,i(r)}();var e=r[s];if(e.length>=3){var h=t.J((function(){s++,o()}));return void e.call({},t.X,t.P,h)}e.call({},t.X,t.P),s++,o()}catch(t){console.warn("XMLHttpRequest: Exception in request handler",t),n||(s++,o())}};o()}))},t.N=function(t,i){if("string"==typeof t){var n=d(d({},i||{}),{ajaxType:"fetch",headers:{},url:t});if(i&&i.headers)for(var r=i.headers instanceof Headers?i.headers:new Headers(i.headers),e=Array.from(r.entries()),s=0;s<e.length;s++){var o=(h=e[s])[0];(u=h[1])&&(n.headers[o]=u)}return n}r=t.headers||(i&&i.headers?i.headers:null),n=d(d({},i||{}),{ajaxType:"fetch",method:t.method,url:t.url,timeout:0,headers:{},body:t.body,cache:t.cache,credentials:t.credentials,integrity:t.integrity,keepalive:t.keepalive,mode:t.mode,redirect:t.redirect,referrer:t.referrer,referrerPolicy:t.referrerPolicy,signal:t.signal});if(r)for(e=Array.from(r.entries()),s=0;s<e.length;s++){var h,u;o=(h=e[s])[0];(u=h[1])&&(n.headers[o]=u)}return n},t.S=function(){return{ajaxType:"fetch",status:0,statusText:"",headers:{},ok:!0,redirected:!1,type:"basic",url:"",body:null}},t.prototype.U=function(t){var i=this,n=function(n){n&&"object"==typeof n?(i.P=n,t()):t()};return n.moveToHeaderReceived=function(){},n.moveToLoading=function(){},n},t.prototype.J=function(t){var i=this;return function(n){n&&"object"==typeof n?(i.P=n,t()):t()}},t}();e.setXMLHttpRequest(l),e.setFetch((function(t,i){return new p(t,i).dispatch()})),e.enable();i.default=e}]).default}));
//# sourceMappingURL=xspy.es5.min.js.map