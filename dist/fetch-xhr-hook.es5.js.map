{"version":3,"sources":["webpack://fetchXhrHook/webpack/universalModuleDefinition","webpack://fetchXhrHook/webpack/bootstrap","webpack://fetchXhrHook/./src/Proxy.ts","webpack://fetchXhrHook/./src/index.lib.ts","webpack://fetchXhrHook/./src/index.ts","webpack://fetchXhrHook/./src/modules/Response.ts","webpack://fetchXhrHook/./src/modules/XMLHttpRequest.ts","webpack://fetchXhrHook/./src/modules/fetch.ts"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AC9EA;AAAA;AAAA;IAAA;IAyGA,CAAC;IA/Fe,YAAM,GAApB;QACE,MAAM,CAAC,cAAc,GAAG,KAAK,CAAC,UAAU,CAAC;QACzC,0BAA0B;QAC1B,IAAG,MAAM,CAAC,KAAK,EAAC;YACd,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,YAAY,CAAC;SACnC;IACH,CAAC;IAEa,aAAO,GAArB;QACE,MAAM,CAAC,cAAc,GAAG,KAAK,CAAC,WAAW,CAAC;QAC1C,0BAA0B;QAC1B,IAAG,MAAM,CAAC,KAAK,IAAI,KAAK,CAAC,aAAa,EAAC;YACrC,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,aAAa,CAAC;SACpC;IACH,CAAC;IAEa,eAAS,GAAvB;QACE,OAAO,MAAM,CAAC,cAAc,KAAK,KAAK,CAAC,UAAU,CAAC;IACpD,CAAC;IAEa,uBAAiB,GAA/B,UAAgC,CAAkC;QAChE,KAAK,CAAC,UAAU,GAAG,CAAC,CAAC;IACvB,CAAC;IAEa,cAAQ,GAAtB,UAAuB,CAAyB;QAC9C,KAAK,CAAC,YAAY,GAAG,CAAC,CAAC;IACzB,CAAC;IAEa,yBAAmB,GAAjC;QACE,IAAM,SAAS,GAAG,KAAK,CAAC,aAAa,CAAC;QACtC,OAAO,SAAS,CAAC,KAAK,EAAE,CAAC;IAC3B,CAAC;IAEa,0BAAoB,GAAlC;QACE,IAAM,SAAS,GAAG,KAAK,CAAC,aAAa,CAAC;QACtC,OAAO,SAAS,CAAC,KAAK,EAAE,CAAC;IAC3B,CAAC;IAEa,eAAS,GAAvB,UAAwB,QAAuC,EAAE,CAAU;QACzE,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC;QACrC,IAAI,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE;YACpC,OAAO;SACR;QAED,IAAI,OAAO,CAAC,KAAK,QAAQ,EAAE;YACzB,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC;SAClC;aAAM;YACL,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC1B;IACH,CAAC;IAEa,gBAAU,GAAxB,UAAyB,QAAuC;QAC9D,IAAI,CAAC,oBAAoB,CAAC,SAAS,EAAE,QAAQ,CAAC,CAAC;IACjD,CAAC;IAEa,gBAAU,GAAxB,UAAyB,QAAwC,EAAE,CAAU;QAC3E,IAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC;QACrC,IAAI,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE;YACpC,OAAO;SACR;QAED,IAAI,OAAO,CAAC,KAAK,QAAQ,EAAE;YACzB,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,QAAQ,CAAC,CAAC;SAClC;aAAM;YACL,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC1B;IACH,CAAC;IAEa,iBAAW,GAAzB,UAA0B,QAAwC;QAChE,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,QAAQ,CAAC,CAAC;IAClD,CAAC;IAEa,cAAQ,GAAtB;QACE,KAAK,CAAC,mBAAmB,EAAE,CAAC;QAC5B,KAAK,CAAC,oBAAoB,EAAE,CAAC;IAC/B,CAAC;IAEa,yBAAmB,GAAjC;QACE,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;IAC1B,CAAC;IAEa,0BAAoB,GAAlC;QACE,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;IAC1B,CAAC;IAEc,0BAAoB,GAAnC,UAAoC,IAAe,EAAE,QAAwE;QAC3H,IAAM,SAAS,GAAG,IAAI,KAAK,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC;QAE/E,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YACzC,IAAI,SAAS,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;gBAC7B,SAAS,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;gBACvB,OAAO;aACR;SACF;IACH,CAAC;IAvGc,mBAAa,GAAyC,EAAE,CAAC;IACzD,mBAAa,GAA0C,EAAE,CAAC;IAC1D,gBAAU,GAAG,MAAM,CAAC,cAAc,CAAC;IACnC,kBAAY,GAAG,MAAM,CAAC,KAAK,CAAC;IACpB,iBAAW,GAAG,MAAM,CAAC,cAAc,CAAC;IAC3D,gFAAgF;IAChF,0BAA0B;IACH,mBAAa,GAAG,CAAC,MAAM,CAAC,KAAK,IAAI,SAAS,KAAK,KAAI,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAiGpG,YAAC;CAAA;AAzGiB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJlB,IAAM,SAAS,GAAG,OAAO,SAAS,KAAK,WAAW,IAAI,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC;AAErG,8CAA8C;AACvC,IAAM,SAAS,GAAG,CAAC;IACxB,IAAI,OAAO,GAAG,QAAQ,CAAC,CAAC,YAAY,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;IAElF,0BAA0B;IAC1B,IAAG,KAAK,CAAC,OAAO,CAAC,EAAE;QACjB,OAAO,GAAG,QAAQ,CAAC,CAAC,uBAAuB,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;QACzF,0BAA0B;QAC1B,IAAG,KAAK,CAAC,OAAO,CAAC,EAAC;YAChB,OAAO,KAAK,CAAC;SACd;QACD,0BAA0B;QAC1B,OAAO,OAAO,CAAC;KAChB;IAED,0BAA0B;IAC1B,OAAO,OAAO,CAAC;AACjB,CAAC,CAAC,EAAE,CAAC;AAEL,0BAA0B;AACnB,SAAS,IAAI,CAAC,EAA0B,EAAE,OAAgB;IAC/D,IAAG,SAAS,KAAK,KAAK;QAAE,OAAO,KAAK,CAAC;SAChC,IAAG,CAAC,OAAO;QAAE,OAAO,IAAI,CAAC;SACzB,IAAG,EAAE,KAAK,GAAG;QAAE,OAAO,SAAS,GAAG,OAAO,CAAC;SAC1C,IAAG,EAAE,KAAK,IAAI;QAAE,OAAO,SAAS,IAAI,OAAO,CAAC;SAC5C,IAAG,EAAE,KAAK,GAAG;QAAE,OAAO,SAAS,GAAG,OAAO,CAAC;SAC1C,IAAG,EAAE,KAAK,IAAI;QAAE,OAAO,SAAS,IAAI,OAAO,CAAC;SAC5C,IAAG,EAAE,KAAK,GAAG;QAAE,OAAO,SAAS,KAAK,OAAO,CAAC;IACjD,OAAO,SAAS,KAAK,OAAO,CAAC;AAC/B,CAAC;AAEM,IAAM,WAAW,GAAG,UAAC,IAAY;IACtC,IAAG;QACD,0BAA0B;QAC1B,IAAG,CAAC,IAAI,EAAE,IAAI,OAAO,KAAK,KAAK,WAAW,EAAC;YACzC,OAAO,IAAI,KAAK,CAAC,IAAI,CAAC,CAAC;SACxB;QAED,+CAA+C;QAC/C,0BAA0B;QAC1B,IAAM,EAAE,GAAG,MAAM,CAAC,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;QAChD,0BAA0B;QAC1B,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;QACnB,0BAA0B;QAC1B,OAAO,EAAE,CAAC;KACX;IACD,OAAM,CAAC,EAAC;QACN,0BAA0B;QAC1B,OAAO;YACL,IAAI;SACI,CAAC;KACZ;AACH,CAAC,CAAC;AAEK,IAAM,WAAW,GAAG,UAAC,eAAuB;IACjD,IAAM,OAAO,GAAG,eAAe,CAAC,IAAI,EAAE,CAAC,KAAK,CAAC,SAAS,CAAC;IAEvD,IAAM,GAAG,GAA6B,EAAE,CAAC;IACzC,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,OAAO,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;QAC/B,IAAM,IAAI,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;QACxB,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC/B,IAAM,IAAI,GAAG,KAAK,CAAC,KAAK,EAAE,CAAC;QAC3B,IAAG,IAAI,EAAC;YACN,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;YACrC,GAAG,CAAC,SAAS,CAAC,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACnC;KACF;IAED,OAAO,GAAG,CAAC;AACb,CAAC;AAEM,IAAM,cAAc,GAAG,UAAC,SAAmC;IAChE,IAAM,OAAO,GAAa,EAAE,CAAC;IAC7B,IAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IAEpC,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,IAAI,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;QAC5B,IAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;QACpB,IAAM,IAAI,GAAG,GAAG,CAAC,WAAW,EAAE,CAAC;QAC/B,IAAM,KAAK,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC;QAE7B,OAAO,CAAC,IAAI,CAAC,IAAI,GAAG,IAAI,GAAG,KAAK,CAAC,CAAC;KACnC;IAED,OAAO,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,MAAM,CAAC;AACvC,CAAC,CAAC;AAEK,IAAM,iBAAiB,GAAG,UAAC,IAAY,EAAE,MAAc,EAAE,gBAAiC,EAAE,KAAiB;IAApD,2DAAiC;IAAE,iCAAiB;IAClH,IAAM,EAAE,yBACH,WAAW,CAAC,IAAI,CAAC,KACpB,IAAI,QACJ,MAAM,EAAE,IAAI,EACZ,MAAM;QACN,gBAAgB;QAChB,KAAK,UACN,CAAC;IAEF,OAAO,EAAE,CAAC;AACZ,CAAC;;;;;;;;;;;;;ACnGD;AAAA;AAAA;AAAA;AAA8B;AAEoB;AACP;AAI3C,4CAAK,CAAC,iBAAiB,CAAC,gEAAQ,CAAC,CAAC;AAClC,4CAAK,CAAC,QAAQ,CAAC,yDAAU,CAAC,CAAC;AAC3B,4CAAK,CAAC,MAAM,EAAE,CAAC;AAEA,2GAAK,EAAC;;;;;;;;;;;;;ACXrB;AAAA;AAAA;IAiBE,uBAAmB,IAAsB,EAAE,IAAmB;QAC5D,IAAI,CAAC,SAAS,GAAG,IAAI,QAAQ,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAC1C,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAClB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAElB,IAAI,CAAC,OAAO,GAAG,IAAI,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;QAC5D,IAAI,CAAC,EAAE,GAAG,KAAK,CAAC;QAChB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;QACxB,IAAI,CAAC,MAAM,GAAG,IAAI,IAAI,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;QACpD,IAAI,CAAC,UAAU,GAAG,IAAI,IAAI,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,EAAE,CAAC;QACjE,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC;QACtC,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC;QACpB,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;QAEd,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;QAChC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;IAC1C,CAAC;IAEa,mBAAK,GAAnB;QACE,OAAO,QAAQ,CAAC,KAAK,EAAE,CAAC;IAC1B,CAAC;IAEa,sBAAQ,GAAtB,UAAuB,GAAW,EAAE,MAAe;QACjD,OAAO,QAAQ,CAAC,QAAQ,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;IACxC,CAAC;IAEM,6BAAK,GAAZ;QACE,OAAO,IAAI,aAAa,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;IACnD,CAAC;IAEM,mCAAW,GAAlB;QACE,OAAO,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,CAAC;IACtC,CAAC;IAEM,4BAAI,GAAX;QACE,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;IAC/B,CAAC;IAEM,gCAAQ,GAAf;QACE,OAAO,IAAI,CAAC,SAAS,CAAC,QAAQ,EAAE,CAAC;IACnC,CAAC;IAEM,4BAAI,GAAX;QACE,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;IAC/B,CAAC;IAEM,4BAAI,GAAX;QACE,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;IAC/B,CAAC;IACH,oBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjE8F;AAChE;AAE/B;IAoEE;QA7DgB,WAAM,GAAW,CAAC,CAAC;QACnB,WAAM,GAAW,CAAC,CAAC;QACnB,qBAAgB,GAAW,CAAC,CAAC;QAC7B,YAAO,GAAW,CAAC,CAAC;QACpB,SAAI,GAAW,CAAC,CAAC;QAEzB,SAAI,GAAG,IAAI,4CAAK,CAAC,WAAW,EAAE,CAAC;QAC/B,eAAU,GAAmH,EAAE,CAAC;QAChI,gBAAW,GAAW,CAAC,CAAC;QACxB,eAAU,GAAY,KAAK,CAAC;QAC5B,cAAS,GAAiB,IAAI,CAAC;QAC/B,mBAAc,GAAiB,IAAI,CAAC;QACpC,aAAQ,GAAe,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC1D,cAAS,GAAgB,QAAQ,CAAC,eAAe,EAAE,CAAC;QACpD,kBAAa,GAAW,EAAE,CAAC;QAC3B,iBAAY,GAAoB,IAAI,CAAC;QAEtC,eAAU,GAAG,CAAC,CAAC;QACf,WAAM,GAAG,CAAC,CAAC;QACX,eAAU,GAAG,EAAE,CAAC;QAChB,YAAO,GAAW,CAAC,CAAC;QACX,WAAM,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;QAEnC,aAAQ,GAAqC,EAAE,CAAC;QAChD,iBAAY,GAA+B,EAAE,CAAC;QAC9C,gBAAW,GAAW,EAAE,CAAC;QAyBzB,oBAAe,GAAY,KAAK,CAAC;QAEjC,uBAAkB,GAA0D,IAAI,CAAC;QACjF,YAAO,GAA0D,IAAI,CAAC;QACtE,YAAO,GAA0D,IAAI,CAAC;QACtE,gBAAW,GAA0D,IAAI,CAAC;QAC1E,WAAM,GAA0D,IAAI,CAAC;QACrE,cAAS,GAA0D,IAAI,CAAC;QACxE,cAAS,GAA0D,IAAI,CAAC;QACxE,eAAU,GAA0D,IAAI,CAAC;QAG9E,IAAI,CAAC,KAAK,EAAE,CAAC;IACf,CAAC;IArCD,sBAAW,kCAAY;aAAvB;YACE,IAAG,IAAI,CAAC,YAAY,KAAK,MAAM,IAAI,IAAI,CAAC,YAAY,KAAK,EAAE,EAAC;gBAC1D,OAAO,IAAI,CAAC,aAAa,CAAC;aAC3B;YACD,0BAA0B;iBACrB,IAAG,uDAAI,CAAC,IAAI,EAAE,EAAE,CAAC,EAAC;gBACrB,OAAO,IAAI,CAAC,aAAa,CAAC;aAC3B;YACD,IAAM,CAAC,GAAG,IAAI,KAAK,CAAC,iEAAiE,CAAC,CAAC;YACvF,CAAC,CAAC,IAAI,GAAG,mBAAmB,CAAC;YAC7B,MAAM,CAAC,CAAC;QACV,CAAC;;;OAAA;IACD,sBAAW,iCAAW;aAAtB;YACE,IAAG,IAAI,CAAC,YAAY,KAAK,UAAU,IAAI,IAAI,CAAC,YAAY,KAAK,EAAE,EAAC;gBAC9D,OAAO,IAAI,CAAC,YAAY,CAAC;aAC1B;YACD,0BAA0B;iBACrB,IAAG,uDAAI,CAAC,IAAI,EAAE,EAAE,CAAC,EAAC;gBACrB,OAAO,IAAI,CAAC,YAAY,CAAC;aAC1B;YACD,IAAM,CAAC,GAAG,IAAI,KAAK,CAAC,oEAAoE,CAAC,CAAC;YAC1F,CAAC,CAAC,IAAI,GAAG,mBAAmB,CAAC;YAC7B,MAAM,CAAC,CAAC;QACV,CAAC;;;OAAA;IAgBO,wBAAK,GAAb;QAAA,iBA4CC;QA3CC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACzC,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAErE,IAAM,gBAAgB,GAAG,UAAyC,IAAO;YACvE,KAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,KAAI,CAAC,QAAQ,CAAC,CAAC;QAC7C,CAAC;QACD,gBAAgB,CAAC,OAAO,CAAC,CAAC;QAC1B,gBAAgB,CAAC,SAAS,CAAC,CAAC;QAC5B,gBAAgB,CAAC,OAAO,CAAC,CAAC;QAE1B,IAAI,CAAC,IAAI,CAAC,kBAAkB,GAAG;YAC7B,+DAA+D;YAC/D,2CAA2C;YAC3C,qDAAqD;YACrD;;;;cAIE;YAEF,IAAM,cAAc,GAAG,KAAI,CAAC,IAAI,CAAC,UAAU,CAAC;YAE5C,IAAG,cAAc,KAAK,KAAI,CAAC,gBAAgB,EAAC;gBAC1C,wBAAwB;gBACxB,IAAG,uDAAI,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,0BAA0B,CAAC,KAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,KAAK,EAAC;oBAC3E,oHAAoH;oBACpH,8CAA8C;iBAC/C;qBACG;oBACF,KAAI,CAAC,mCAAmC,EAAE,CAAC;iBAC5C;aACF;iBACI,IAAG,cAAc,KAAK,KAAI,CAAC,OAAO,EAAC;gBACtC,KAAI,CAAC,mCAAmC,EAAE,CAAC;aAC5C;iBACI,IAAG,cAAc,KAAK,KAAI,CAAC,IAAI,EAAC;gBACnC,KAAI,CAAC,cAAc,GAAG,KAAK,CAAC;gBAC5B,KAAI,CAAC,mCAAmC,EAAE,CAAC;gBAC3C,KAAI,CAAC,iCAAiC,EAAE,CAAC;aAC1C;YAED,KAAI,CAAC,SAAS,CAAC,cAAc,CAAC,CAAC;QACjC,CAAC,CAAC;IACJ,CAAC;IAEM,mCAAgB,GAAvB,UACE,IAAO,EACP,QAA+F,EAC/F,OAA2C;QAE3C,IAAG,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAC;YACxB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC;SAC5B;QAED,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACvC,CAAC;IAEM,sCAAmB,GAA1B,UACE,IAAO,EACP,QAA2F,EAC3F,OAAwC;QAExC,IAAG,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAC;YACxB,OAAO;SACR;QAED,IAAM,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC;QACtD,IAAG,KAAK,GAAG,CAAC,EAAC;YACX,OAAO;SACR;QAED,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;IACzC,CAAC;IAEM,gCAAa,GAApB,UAAqB,KAAqD;QACxE,IAAG,OAAO,KAAK,KAAK,QAAQ,EAAC;YAC3B,MAAM,IAAI,SAAS,CAAC,wDAAwD,CAAC,CAAC;SAC/E;QAED,IAAM,iBAAiB,GAAG,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC;QAC5C,IAAG,iBAAiB,KAAK,SAAS;eAC7B,iBAAiB,KAAK,SAAS;eAC/B,iBAAiB,KAAK,QAAQ;eAC9B,iBAAiB,KAAK,WAAW;eACjC,iBAAiB,KAAK,aAAa;eACnC,iBAAiB,KAAK,YAAY;eAClC,iBAAiB,KAAK,WAAW,EACrC;YACC,IAAM,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACxC,IAAG,OAAO,EAAC;gBACT,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,KAAiD,CAAC,CAAC;aACvE;SACF;aACI,IAAG,iBAAiB,KAAK,oBAAoB,EAAC;YACjD,IAAM,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,CAAC;YACxC,IAAG,OAAO,EAAC;gBACT,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,KAAc,CAAC,CAAC;aACpC;SACF;QAED,IAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAC9C,IAAG,CAAC,SAAS,EAAC;YACZ,OAAO,IAAI,CAAC;SACb;QAED,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,SAAS,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;YACjC,IAAM,CAAC,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;YACvB,CAAC,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;SACrB;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAEM,mCAAgB,GAAvB,UAAwB,IAAY;QAClC,OAAO,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAC1D,CAAC;IAEM,uBAAI,GAAX,UAAY,MAAc,EAAE,GAAW,EAAE,KAAe,EAAE,QAAsB,EAAE,QAAsB;QACtG,IAAG,SAAS,CAAC,MAAM,GAAG,CAAC,EAAC;YACtB,MAAM,IAAI,SAAS,CAAC,uBAAuB,GAAG,SAAS,CAAC,MAAM,GAAG,iDAAiD,CAAC,CAAC;SACrH;QAED,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC;QACrB,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QACvB,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;QACxB,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAE5B,IAAI,CAAC,QAAQ,yBACR,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,KACrC,OAAO,EAAE,EAAE,EACX,MAAM;YACN,GAAG,OACH,KAAK,EAAE,KAAK,KAAK,KAAK,EACtB,QAAQ;YACR,QAAQ,aACT,CAAC;QAEF,IAAI,CAAC,SAAS,yBACT,QAAQ,CAAC,eAAe,EAAE,KAC7B,OAAO,EAAE,EAAE,GACZ,CAAC;QAEF,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAC9B,CAAC;IAEM,uBAAI,GAAX,UAAY,IAAiC;QAA7C,iBAyFC;QAxFC,IAAG,IAAI,CAAC,WAAW,KAAK,IAAI,CAAC,MAAM,EAAC;YAClC,MAAM,IAAI,YAAY,CAAC,qCAAqC,CAAC,CAAC;SAC/D;QAED,IAAI,CAAC,8BAA8B,CAAC,IAAI,CAAC,CAAC;QAC1C,IAAI,CAAC,wBAAwB,EAAE,CAAC;QAEhC,IAAI,uBAAuB,GAAG,KAAK,CAAC;QAEpC,IAAM,eAAe,GAAG;YACtB,uBAAuB,GAAG,IAAI,CAAC;YAE/B,mFAAmF;YACnF,8BAA8B;YAC9B,IAAG,KAAI,CAAC,WAAW,KAAK,KAAI,CAAC,IAAI,EAAC;gBAChC,OAAO;aACR;YAED,KAAI,CAAC,cAAc,GAAG,IAAI,CAAC;YAE3B,IAAM,KAAK,GAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,KAAK,CAAC;YAE5C,KAAI,CAAC,IAAI,CAAC,IAAI,CACZ,KAAI,CAAC,QAAQ,CAAC,MAAM,EACpB,KAAI,CAAC,QAAQ,CAAC,GAAG,EACjB,KAAK,EACL,KAAI,CAAC,QAAQ,CAAC,QAAQ,EACtB,KAAI,CAAC,QAAQ,CAAC,QAAQ,CACvB,CAAC;YAEF,IAAG,KAAK,EAAC;gBACP,KAAI,CAAC,IAAI,CAAC,YAAY,GAAG,KAAI,CAAC,YAAY,CAAC;gBAC3C,KAAI,CAAC,IAAI,CAAC,OAAO,GAAG,KAAI,CAAC,OAAO,CAAC;aAClC;YACD,KAAI,CAAC,IAAI,CAAC,eAAe,GAAG,KAAI,CAAC,eAAe,CAAC;YAEjD,KAAI,CAAC,aAAa,CAAC,oEAAiB,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;YAEtD,IAAM,SAAS,GAAG,KAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;YACxC,IAAM,WAAW,GAAG,SAAS,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;YAC5D,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,WAAW,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;gBACnC,IAAM,UAAU,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC;gBAClC,IAAM,WAAW,GAAG,SAAS,CAAC,UAAU,CAAC,CAAC;gBAC1C,KAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;aACrD;YAED,KAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;QACrC,CAAC,CAAC;QAEF,IAAM,SAAS,GAAG,4CAAK,CAAC,mBAAmB,EAAE,CAAC;QAC9C,IAAI,eAAe,GAAG,CAAC,CAAC;QAExB,IAAM,mBAAmB,GAAG;YAC1B,IAAG;gBACD,IAAG,eAAe,IAAI,SAAS,CAAC,MAAM,EAAC;oBACrC,OAAO,eAAe,EAAE,CAAC;iBAC1B;gBAED,IAAM,CAAC,GAAG,SAAS,CAAC,eAAe,CAAC,CAAC;gBAErC,oCAAoC;gBACpC,IAAG,CAAC,CAAC,MAAM,IAAI,CAAC,EAAC;oBACf,IAAM,YAAY,GAAG,KAAI,CAAC,sBAAsB,CAAC;wBAC/C,eAAe,EAAE,CAAC;wBAClB,mBAAmB,EAAE,CAAC;oBACxB,CAAC,CAAC,CAAC;oBAEH,CAAC,CAAC,IAAI,CAAC,KAAI,EAAE,KAAI,CAAC,QAAQ,EAAE,YAA8C,CAAC,CAAC;oBAC5E,OAAO;iBACR;gBAED,0BAA0B;gBAC1B,CAAC,CAAC,IAAI,CAAC,KAAI,EAAE,KAAI,CAAC,QAAQ,CAAC,CAAC;gBAE5B,eAAe,EAAE,CAAC;gBAClB,mBAAmB,EAAE,CAAC;aACvB;YACD,OAAM,CAAC,EAAC;gBACN,OAAO,CAAC,IAAI,CAAC,8CAA8C,EAAE,CAAC,CAAC,CAAC;gBAEhE,IAAG,CAAC,uBAAuB,EAAC;oBAC1B,eAAe,EAAE,CAAC;oBAClB,mBAAmB,EAAE,CAAC;iBACvB;aACF;QACH,CAAC,CAAC;QAEF,mBAAmB,EAAE,CAAC;IACxB,CAAC;IAEM,mCAAgB,GAAvB,UAAwB,IAAY,EAAE,KAAa;QACjD,IAAG,IAAI,CAAC,UAAU,KAAK,IAAI,CAAC,MAAM,EAAC;YACjC,MAAM,IAAI,YAAY,CAAC,qCAAqC,CAAC,CAAC;SAC/D;QAED,IAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAC;YACxB,IAAI,CAAC,QAAQ,CAAC,OAAO,GAAG,EAAE,CAAC;SAC5B;QAED,IAAM,SAAS,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;QACrC,IAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,EAAC;YAClC,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,IAAI,GAAG,KAAK,CAAC;SACzD;QAED,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,KAAK,CAAC;IAC3C,CAAC;IAEM,oCAAiB,GAAxB,UAAyB,IAAY;QACnC,IAAM,eAAe,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;QAC3C,IAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,gBAAgB,IAAI,CAAC,CAAC,eAAe,IAAI,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,EAAC;YACzF,iDAAiD;YACjD,0BAA0B;YAC1B,IAAG,uDAAI,CAAC,IAAI,EAAE,CAAC,CAAC,EAAC;gBACf,IAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,MAAM,EAAC;oBAC/B,MAAM,IAAI,KAAK,EAAE,CAAC;iBACnB;gBACD,OAAO,EAAE,CAAC;aACX;YACD,OAAO,IAAI,CAAC;SACb;QACD,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC;IACjD,CAAC;IAEM,wCAAqB,GAA5B;QACE,IAAG,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,gBAAgB,EAAC;YACzC,wFAAwF;YACxF,wFAAwF;YACxF,qDAAqD;YACrD,+BAA+B;YAE/B,iDAAiD;YACjD,0BAA0B;YAC1B,IAAG,uDAAI,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,MAAM,EAAC;gBAChD,MAAM,IAAI,KAAK,EAAE,CAAC;aACnB;YACD,OAAO,EAAE,CAAC;SACX;QACD,OAAO,iEAAc,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,CAAC;IAChD,CAAC;IAEM,wBAAK,GAAZ;QACE,2IAA2I;QAC3I,6EAA6E;QAC7E,uDAAuD;QACvD;;;;SAIC;QAED,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;QACvB,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;QAChB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC;QAC9B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC;QAE/B,IAAG,IAAI,CAAC,cAAc,EAAC;YACrB,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;SACnB;aACG;YACF,IAAI,CAAC,aAAa,CAAC,oEAAiB,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC;SACnD;QAED,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;IAC9B,CAAC;IAEc,uBAAc,GAA7B,UAA8B,GAAmB;QAC/C,OAAO;YACL,QAAQ,EAAE,KAAc;YACxB,OAAO,EAAE,EAAE;YACX,MAAM,EAAE,KAAK;YACb,GAAG,EAAE,EAAE;YACP,KAAK,EAAE,IAAI;YACX,OAAO,EAAE,CAAC;YACV,MAAM,EAAE,GAAG,CAAC,MAAM;SACnB,CAAC;IACJ,CAAC;IAEc,wBAAe,GAA9B;QACE,OAAO;YACL,QAAQ,EAAE,KAAc;YACxB,MAAM,EAAE,CAAC;YACT,UAAU,EAAE,EAAE;YACd,QAAQ,EAAE,EAAE;YACZ,YAAY,EAAE,EAAW;YACzB,OAAO,EAAE,EAAE;SACZ,CAAC;IACJ,CAAC;IAEO,iDAA8B,GAAtC,UAAuC,IAAiC;QACtE,IAAI,CAAC,QAAQ,CAAC,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC;QAC/C,IAAI,CAAC,QAAQ,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QACrC,IAAI,CAAC,QAAQ,CAAC,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC;QACrD,IAAI,CAAC,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC;QAC1B,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,OAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACzF,IAAI,CAAC,IAAI,CAAC,OAAO,GAAG,OAAM,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACzF,IAAI,CAAC,IAAI,CAAC,SAAS,GAAG,OAAM,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QAC/F,IAAI,CAAC,IAAI,CAAC,UAAU,GAAG,OAAM,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;IACpG,CAAC;IAEO,2CAAwB,GAAhC;QAAA,iBAgBC;QAfC,IAAM,iBAAiB,GAAG,UAAyC,IAAO;YACxE,IAAM,cAAc,GAAG,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YAC7C,IAAG,CAAC,cAAc,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAC;gBAC9C,OAAO;aACR;YAED,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,cAAc,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;gBACtC,KAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC,CAAC;aAChE;QACH,CAAC,CAAC;QAEF,iBAAiB,CAAC,OAAO,CAAC,CAAC;QAC3B,iBAAiB,CAAC,OAAO,CAAC,CAAC;QAC3B,iBAAiB,CAAC,SAAS,CAAC,CAAC;QAC7B,iBAAiB,CAAC,UAAU,CAAC,CAAC;IAChC,CAAC;IAEO,yCAAsB,GAA9B,UAA+B,QAAuB;QAAtD,iBAmDC;QA5CC,IAAM,EAAE,GAAuC,UAAC,QAAqB;YACnE,IAAG,CAAC,QAAQ,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAC;gBAC3C,QAAQ,EAAE,CAAC;gBACX,OAAO;aACR;YAED,KAAI,CAAC,aAAa,CAAC,oEAAiB,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,CAAC;YAEtD,KAAI,CAAC,SAAS,yBACT,KAAI,CAAC,SAAS,GACd,QAAQ,CACZ,CAAC;YAEF,KAAI,CAAC,SAAS,CAAC,KAAI,CAAC,IAAI,CAAC,CAAC;YAE1B,QAAQ,EAAE,CAAC;QACb,CAAC,CAAC;QAEF,IAAM,oBAAoB,GAAG,UAAC,QAAqB;YACjD,IAAG,KAAI,CAAC,UAAU,IAAI,KAAI,CAAC,gBAAgB,EAAC;gBAC1C,OAAO;aACR;YACD,KAAI,CAAC,SAAS,yBACT,KAAI,CAAC,SAAS,GACd,QAAQ,CACZ,CAAC;YACF,KAAI,CAAC,SAAS,CAAC,KAAI,CAAC,gBAAgB,CAAC,CAAC;QACxC,CAAC,CAAC;QAEF,IAAM,aAAa,GAAG,UAAC,QAAqB;YAC1C,IAAG,KAAI,CAAC,UAAU,IAAI,KAAI,CAAC,OAAO,EAAC;gBACjC,OAAO;aACR;YACD,KAAI,CAAC,SAAS,yBACT,KAAI,CAAC,SAAS,GACd,QAAQ,CACZ,CAAC;YACF,KAAI,CAAC,SAAS,CAAC,KAAI,CAAC,OAAO,CAAC,CAAC;QAC/B,CAAC,CAAC;QAEF,EAAE,CAAC,oBAAoB,GAAG,oBAAoB,CAAC;QAC/C,EAAE,CAAC,aAAa,GAAG,aAAa,CAAC;QAEjC,OAAO,EAA4B,CAAC;IACtC,CAAC;IAEO,0CAAuB,GAA/B,UAAgC,QAAuB;QAAvD,iBAcC;QAbC,OAAO,UAAC,QAAqB;YAC3B,IAAG,CAAC,QAAQ,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAC;gBAC3C,QAAQ,EAAE,CAAC;gBACX,OAAO;aACR;YAED,KAAI,CAAC,SAAS,yBACT,KAAI,CAAC,SAAS,GACd,QAAQ,CACZ,CAAC;YAEF,QAAQ,EAAE,CAAC;QACb,CAAC,CAAC;IACJ,CAAC;IAEO,sDAAmC,GAA3C;QACE,IAAI,CAAC,SAAS,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;QACzC,IAAG,CAAC,IAAI,CAAC,UAAU,EAAC;YAClB,IAAI,CAAC,SAAS,CAAC,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC;SAClD;aACG;YACF,OAAO;SACR;QAED,IAAM,eAAe,GAAG,IAAI,CAAC,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC1D,IAAM,SAAS,GAAG,8DAAW,CAAC,eAAe,CAAC,CAAC;QAE/C,IAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QACpC,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,IAAI,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;YAC5B,IAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;YACpB,IAAM,KAAK,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC;YAC7B,IAAG,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,EAAC;gBAC9B,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;aACrC;SACF;IACH,CAAC;IAEO,oDAAiC,GAAzC;QACE,IAAG,CAAC,IAAI,CAAC,IAAI,CAAC,YAAY,EAAC;YACzB,IAAI,CAAC,SAAS,CAAC,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC;YACrD,IAAI,CAAC,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;YACnD,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC;SAClD;aACI,IAAG,IAAI,CAAC,IAAI,CAAC,YAAY,KAAK,MAAM,EAAC;YACxC,IAAI,CAAC,SAAS,CAAC,YAAY,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC;YACrD,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC;SAClD;aACI,IAAG,IAAI,CAAC,IAAI,CAAC,YAAY,KAAK,UAAU,EAAC;YAC5C,IAAI,CAAC,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;YACnD,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;SACjD;aACG;YACF,IAAI,CAAC,SAAS,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC;SAC9C;QAED,IAAG,aAAa,IAAI,IAAI,CAAC,IAAI,EAAC;YAC5B,IAAI,CAAC,SAAS,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC;SACpD;IACH,CAAC;IAEO,iDAA8B,GAAtC;QACE,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;QACpC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC;QAC5C,iFAAiF;QACjF,wDAAwD;IAC1D,CAAC;IAEO,+CAA4B,GAApC;QACE,IAAG,cAAc,IAAI,IAAI,CAAC,SAAS,EAAC;YAClC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,IAAI,EAAE,CAAC;SACxD;QACD,IAAG,aAAa,IAAI,IAAI,CAAC,SAAS,EAAC;YACjC,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,IAAI,IAAI,CAAC;SACxD;QACD,IAAG,MAAM,IAAI,IAAI,CAAC,SAAS,EAAC;YAC1B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,IAAI,IAAI,CAAC;SAC7C;QACD,IAAG,UAAU,IAAI,IAAI,CAAC,SAAS,EAAC;YAC9B,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC;SACzC;QACD,IAAG,aAAa,IAAI,IAAI,CAAC,SAAS,EAAC;YACjC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,SAAS,CAAC,WAAW,IAAI,EAAE,CAAC;SACrD;IACH,CAAC;IAEO,2BAAQ,GAAhB;QACE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;QACtB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC;QAC/B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC;QAC9B,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC;IAClB,CAAC;IAEO,sCAAmB,GAA3B;QAAA,iBAoFC;QAnFC,IAAM,qBAAqB,GAAG,8DAAW,CAAC,kBAAkB,CAAC,CAAC;QAE9D,IAAG,IAAI,CAAC,WAAW,KAAK,IAAI,CAAC,MAAM,EAAC;YAClC,IAAI,CAAC,aAAa,CAAC,qBAAqB,CAAC,CAAC;SAC3C;aACI,IAAG,IAAI,CAAC,WAAW,KAAK,IAAI,CAAC,gBAAgB,EAAC;YACjD,IAAI,CAAC,8BAA8B,EAAE,CAAC;YACtC,IAAI,CAAC,aAAa,CAAC,qBAAqB,CAAC,CAAC;SAC3C;aACI,IAAG,IAAI,CAAC,WAAW,KAAK,IAAI,CAAC,OAAO,EAAC;YACxC,IAAI,CAAC,8BAA8B,EAAE,CAAC;YACtC,IAAI,CAAC,aAAa,CAAC,qBAAqB,CAAC,CAAC;SAC3C;aACI,IAAG,IAAI,CAAC,WAAW,KAAK,IAAI,CAAC,IAAI,EAAC;YACrC,IAAI,CAAC,8BAA8B,EAAE,CAAC;YACtC,IAAI,CAAC,4BAA4B,EAAE,CAAC;YAEpC,IAAI,wBAAsB,GAAG,KAAK,CAAC;YAEnC,IAAM,gBAAc,GAAG;gBACrB,wBAAsB,GAAG,IAAI,CAAC;gBAE9B,+EAA+E;gBAC/E,KAAI,CAAC,8BAA8B,EAAE,CAAC;gBACtC,KAAI,CAAC,4BAA4B,EAAE,CAAC;gBAEpC,KAAI,CAAC,aAAa,CAAC,qBAAqB,CAAC,CAAC;gBAE1C,IAAM,aAAa,GAAG;oBACpB,IAAG,CAAC,KAAI,CAAC,SAAS,EAAC;wBACjB,KAAI,CAAC,aAAa,CAAC,oEAAiB,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC,CAAC;qBAClD;oBACD,KAAI,CAAC,aAAa,CAAC,oEAAiB,CAAC,SAAS,EAAE,CAAC,CAAC,CAAC,CAAC;gBACtD,CAAC,CAAC;gBAEF,IAAG,KAAI,CAAC,QAAQ,CAAC,KAAK,KAAK,KAAK,EAAC;oBAC/B,aAAa,EAAE,CAAC;iBACjB;qBACG;oBACF,MAAM,CAAC,UAAU,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;iBACrC;YACH,CAAC,CAAC;YAEF,IAAM,WAAS,GAAG,4CAAK,CAAC,oBAAoB,EAAE,CAAC;YAC/C,IAAI,iBAAe,GAAG,CAAC,CAAC;YAExB,IAAM,qBAAmB,GAAG;gBAC1B,IAAG;oBACD,IAAG,iBAAe,IAAI,WAAS,CAAC,MAAM,EAAC;wBACrC,OAAO,gBAAc,EAAE,CAAC;qBACzB;oBAED,IAAM,CAAC,GAAG,WAAS,CAAC,iBAAe,CAAC,CAAC;oBAErC,8CAA8C;oBAC9C,IAAG,CAAC,CAAC,MAAM,IAAI,CAAC,EAAC;wBACf,IAAM,YAAY,GAAG,KAAI,CAAC,uBAAuB,CAAC;4BAChD,iBAAe,EAAE,CAAC;4BAClB,qBAAmB,EAAE,CAAC;wBACxB,CAAC,CAAC,CAAC;wBAEH,CAAC,CAAC,IAAI,CAAC,KAAI,EAAE,KAAI,CAAC,QAAQ,EAAE,KAAI,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC;wBAC1D,OAAO;qBACR;oBAED,oCAAoC;oBACpC,CAAC,CAAC,IAAI,CAAC,KAAI,EAAE,KAAI,CAAC,QAAQ,EAAE,KAAI,CAAC,SAAS,CAAC,CAAC;oBAE5C,iBAAe,EAAE,CAAC;oBAClB,qBAAmB,EAAE,CAAC;iBACvB;gBACD,OAAM,CAAC,EAAC;oBACN,OAAO,CAAC,IAAI,CAAC,+CAA+C,EAAE,CAAC,CAAC,CAAC;oBAEjE,IAAG,CAAC,wBAAsB,EAAC;wBACzB,iBAAe,EAAE,CAAC;wBAClB,qBAAmB,EAAE,CAAC;qBACvB;iBACF;YACH,CAAC,CAAC;YAEF,qBAAmB,EAAE,CAAC;SACvB;IACH,CAAC;IAEO,4BAAS,GAAjB,UAAkB,KAAa;QAC7B,OAAM,IAAI,CAAC,WAAW,GAAG,KAAK,IAAI,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,IAAI,EAAC;YAC7D,IAAI,CAAC,WAAW,EAAE,CAAC;YACnB,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,WAAW,CAAC;YAEnC,IAAI,CAAC,mBAAmB,EAAE,CAAC;SAC5B;IACH,CAAC;IAjqBe,eAAM,GAAW,CAAC,CAAC;IACnB,eAAM,GAAW,CAAC,CAAC;IACnB,yBAAgB,GAAW,CAAC,CAAC;IAC7B,gBAAO,GAAW,CAAC,CAAC;IACpB,aAAI,GAAW,CAAC,CAAC;IA8pBnC,eAAC;CAAA;AAnqBoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJU;AAEU;AAEzC;IAME,oBAAmB,KAAkB,EAAE,IAAkB;QACvD,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;QACpB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QAElB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACzC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/C,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACrE,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAEvE,IAAI,CAAC,QAAQ,GAAG,UAAU,CAAC,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;QACvD,IAAI,CAAC,SAAS,GAAG,UAAU,CAAC,eAAe,EAAE,CAAC;IAChD,CAAC;IAEM,6BAAQ,GAAf;QAAA,iBAkFC;QAjFC,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YACjC,IAAM,gBAAgB,GAAG,KAAI,CAAC,SAAS,CAAC;YACxC,IAAI,qBAAqB,GAAG,KAAK,CAAC;YAElC,IAAM,aAAa,GAAG;gBACpB,qBAAqB,GAAG,IAAI,CAAC;gBAE7B,IAAG,gBAAgB,KAAK,KAAI,CAAC,SAAS,EAAC;oBACrC,KAAI,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,UAAC,QAAQ;wBAC/B,OAAO,CAAC,QAAQ,CAAC,CAAC;oBACpB,CAAC,CAAC,CAAC;oBACH,OAAO;iBACR;gBAED,4CAAK,CAAC,aAAa,CAAC,KAAI,CAAC,QAAQ,CAAC,GAAG,EAAE,KAAI,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,kBAAQ;oBACjE,IAAM,OAAO,GAA2B,EAAE,CAAC;oBAC3C,KAAiB,UAAuB,EAAvB,aAAQ,CAAC,OAAO,CAAC,IAAI,EAAE,EAAvB,cAAuB,EAAvB,IAAuB,EAAC;wBAArC,IAAM,GAAG;wBACX,IAAM,KAAK,GAAG,QAAQ,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC;wBACvC,IAAG,KAAK,EAAC;4BACP,OAAO,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;yBACtB;qBACF;oBAED,KAAI,CAAC,SAAS,GAAG;wBACf,QAAQ,EAAE,OAAO;wBACjB,MAAM,EAAE,QAAQ,CAAC,MAAM;wBACvB,UAAU,EAAE,QAAQ,CAAC,UAAU;wBAC/B,OAAO;wBACP,EAAE,EAAE,QAAQ,CAAC,EAAE;wBACf,UAAU,EAAE,QAAQ,CAAC,UAAU;wBAC/B,IAAI,EAAE,QAAQ,CAAC,IAAI;wBACnB,GAAG,EAAE,QAAQ,CAAC,GAAG;wBACjB,IAAI,EAAE,QAAQ,CAAC,IAAI;qBACpB,CAAC;oBAEF,KAAI,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,WAAC;wBACvB,OAAO,CAAC,CAAC,CAAC,CAAC;oBACb,CAAC,CAAC,CAAC;gBACL,CAAC,CAAC,CAAC;YACL,CAAC,CAAC;YAEF,IAAM,gBAAgB,GAAG,4CAAK,CAAC,mBAAmB,EAAE,CAAC;YACrD,IAAI,eAAe,GAAG,CAAC,CAAC;YAExB,IAAM,mBAAmB,GAAG;gBAC1B,IAAG;oBACD,IAAG,eAAe,IAAI,gBAAgB,CAAC,MAAM,EAAC;wBAC5C,OAAO,aAAa,EAAE,CAAC;qBACxB;oBAED,IAAM,CAAC,GAAG,gBAAgB,CAAC,eAAe,CAAC,CAAC;oBAE5C,oCAAoC;oBACpC,IAAG,CAAC,CAAC,MAAM,IAAI,CAAC,EAAC;wBACf,IAAM,YAAY,GAAG,KAAI,CAAC,sBAAsB,CAAC;4BAC/C,eAAe,EAAE,CAAC;4BAClB,mBAAmB,EAAE,CAAC;wBACxB,CAAC,CAAC,CAAC;wBAEH,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,KAAI,CAAC,QAAQ,EAAE,YAA8C,CAAC,CAAC;wBAC1E,OAAO;qBACR;oBAED,0BAA0B;oBAC1B,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,KAAI,CAAC,QAAQ,CAAC,CAAC;oBAE1B,eAAe,EAAE,CAAC;oBAClB,mBAAmB,EAAE,CAAC;iBACvB;gBACD,OAAM,CAAC,EAAC;oBACN,OAAO,CAAC,IAAI,CAAC,8CAA8C,EAAE,CAAC,CAAC,CAAC;oBAEhE,IAAG,CAAC,qBAAqB,EAAC;wBACxB,eAAe,EAAE,CAAC;wBAClB,mBAAmB,EAAE,CAAC;qBACvB;iBACF;YACH,CAAC,CAAC;YAEF,mBAAmB,EAAE,CAAC;QACxB,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,gCAAW,GAAnB;QAAA,iBAsDC;QArDC,OAAO,IAAI,OAAO,CAAW,CAAC,iBAAO;YACnC,IAAI,sBAAsB,GAAG,KAAK,CAAC;YAEnC,IAAM,cAAc,GAAG;gBACrB,sBAAsB,GAAG,IAAI,CAAC;gBAC9B,IAAM,GAAG,GAAG,IAAI,uDAAa,CAAC,KAAI,CAAC,SAAS,CAAC,IAAI,EAAE,KAAI,CAAC,SAAS,CAAC,CAAC;gBACnE,GAAG,CAAC,GAAG,GAAG,KAAI,CAAC,SAAS,CAAC,GAAG,CAAC;gBAC7B,GAAG,CAAC,IAAI,GAAG,KAAI,CAAC,SAAS,CAAC,IAAI,CAAC;gBAC/B,GAAG,CAAC,UAAU,GAAG,KAAI,CAAC,SAAS,CAAC,UAAU,CAAC;gBAC3C,GAAG,CAAC,EAAE,GAAG,KAAI,CAAC,SAAS,CAAC,EAAE,CAAC;gBAC3B,OAAO,CAAC,GAAG,CAAC,CAAC;YACf,CAAC,CAAC;YAEF,IAAM,iBAAiB,GAAG,4CAAK,CAAC,oBAAoB,EAAE,CAAC;YACvD,IAAI,eAAe,GAAG,CAAC,CAAC;YAExB,IAAM,mBAAmB,GAAG;gBAC1B,IAAG;oBACD,IAAG,eAAe,IAAI,iBAAiB,CAAC,MAAM,EAAC;wBAC7C,OAAO,cAAc,EAAE,CAAC;qBACzB;oBAED,IAAM,CAAC,GAAG,iBAAiB,CAAC,eAAe,CAAC,CAAC;oBAE7C,8CAA8C;oBAC9C,IAAG,CAAC,CAAC,MAAM,IAAI,CAAC,EAAC;wBACf,IAAM,YAAY,GAAG,KAAI,CAAC,uBAAuB,CAAC;4BAChD,eAAe,EAAE,CAAC;4BAClB,mBAAmB,EAAE,CAAC;wBACxB,CAAC,CAAC,CAAC;wBAEH,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,KAAI,CAAC,QAAQ,EAAE,KAAI,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC;wBACxD,OAAO;qBACR;oBAED,oCAAoC;oBACpC,CAAC,CAAC,IAAI,CAAC,EAAE,EAAE,KAAI,CAAC,QAAQ,EAAE,KAAI,CAAC,SAAS,CAAC,CAAC;oBAE1C,eAAe,EAAE,CAAC;oBAClB,mBAAmB,EAAE,CAAC;iBACvB;gBACD,OAAM,CAAC,EAAC;oBACN,OAAO,CAAC,IAAI,CAAC,8CAA8C,EAAE,CAAC,CAAC,CAAC;oBAEhE,IAAG,CAAC,sBAAsB,EAAC;wBACzB,eAAe,EAAE,CAAC;wBAClB,mBAAmB,EAAE,CAAC;qBACvB;iBACF;YACH,CAAC,CAAC;YAEF,mBAAmB,EAAE,CAAC;QACxB,CAAC,CAAC,CAAC,CAAC;IACN,CAAC;IAEc,yBAAc,GAA7B,UAA8B,KAAkB,EAAE,IAAkB;QAClE,IAAG,OAAO,KAAK,KAAK,QAAQ,EAAC;YAC3B,IAAM,GAAG,GAAG,sBACP,CAAC,IAAI,IAAE,EAAE,CAAC,KACb,QAAQ,EAAE,OAAO,EACjB,OAAO,EAAE,EAAE,EACX,GAAG,EAAE,KAAK,GACK,CAAC;YAElB,IAAG,IAAI,IAAI,IAAI,CAAC,OAAO,EAAC;gBACtB,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,YAAY,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;gBAE3F;;;;;;;;;;;;;;;;mBAgBG;gBACH,IAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC,CAAC;gBAC9C,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,OAAO,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;oBAC/B,IAAM,IAAI,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;oBACxB,IAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;oBACpB,IAAM,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;oBACtB,IAAG,KAAK,EAAC;wBACP,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;qBAC1B;iBACF;aACF;YAED,OAAO,GAAG,CAAC;SACZ;aACG;YACF,IAAM,OAAO,GAAG,KAAK,CAAC,OAAO,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;YAE9E,IAAM,GAAG,GAAG,sBACP,CAAC,IAAI,IAAE,EAAE,CAAC,KACb,QAAQ,EAAE,OAAO,EACjB,MAAM,EAAE,KAAK,CAAC,MAAM,EACpB,GAAG,EAAE,KAAK,CAAC,GAAG,EACd,OAAO,EAAE,CAAC,EACV,OAAO,EAAE,EAAE;gBACX,2FAA2F;gBAC3F,2FAA2F;gBAC3F,IAAI,EAAE,KAAK,CAAC,IAAI,EAChB,KAAK,EAAE,KAAK,CAAC,KAAK,EAClB,WAAW,EAAE,KAAK,CAAC,WAAW,EAC9B,SAAS,EAAE,KAAK,CAAC,SAAS,EAC1B,SAAS,EAAE,KAAK,CAAC,SAAS,EAC1B,IAAI,EAAE,KAAK,CAAC,IAAI,EAChB,QAAQ,EAAE,KAAK,CAAC,QAAQ,EACxB,QAAQ,EAAE,KAAK,CAAC,QAAQ,EACxB,cAAc,EAAE,KAAK,CAAC,cAAc,EACpC,MAAM,EAAE,KAAK,CAAC,MAAM,GACL,CAAC;YAElB,IAAG,OAAO,EAAC;gBACT,IAAM,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC,CAAC;gBAC9C,KAAI,IAAI,CAAC,GAAC,CAAC,EAAC,CAAC,GAAC,OAAO,CAAC,MAAM,EAAC,CAAC,EAAE,EAAC;oBAC/B,IAAM,IAAI,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC;oBACxB,IAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;oBACpB,IAAM,KAAK,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;oBACtB,IAAG,KAAK,EAAC;wBACP,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;qBAC1B;iBACF;aACF;YAED,OAAO,GAAG,CAAC;SACZ;IACH,CAAC;IAEc,0BAAe,GAA9B;QACE,OAAO;YACL,QAAQ,EAAE,OAAO;YACjB,MAAM,EAAE,CAAC;YACT,UAAU,EAAE,EAAE;YACd,OAAO,EAAE,EAAE;YACX,EAAE,EAAE,IAAI;YACR,UAAU,EAAE,KAAK;YACjB,IAAI,EAAE,OAAO;YACb,GAAG,EAAE,EAAE;YACP,IAAI,EAAE,IAAI;SACX,CAAC;IACJ,CAAC;IAEO,2CAAsB,GAA9B,UAA+B,QAAuB;QAAtD,iBAqBC;QAdC,IAAM,EAAE,GAAuC,UAAC,QAAuB;YACrE,IAAG,CAAC,QAAQ,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAC;gBAC3C,QAAQ,EAAE,CAAC;gBACX,OAAO;aACR;YAED,KAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;YAC1B,QAAQ,EAAE,CAAC;QACb,CAAC,CAAC;QAEF,EAAE,CAAC,oBAAoB,GAAG,cAAQ,OAAO,CAAC,CAAC,CAAC;QAC5C,EAAE,CAAC,aAAa,GAAG,cAAQ,OAAO,CAAC,CAAC,CAAC;QAErC,OAAO,EAA8B,CAAC;IACxC,CAAC;IAEO,4CAAuB,GAA/B,UAAgC,QAAuB;QAAvD,iBAWC;QAVC,OAAO,UAAC,QAAuB;YAC7B,IAAG,CAAC,QAAQ,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAC;gBAC3C,QAAQ,EAAE,CAAC;gBACX,OAAO;aACR;YAED,KAAI,CAAC,SAAS,GAAG,QAAQ,CAAC;YAE1B,QAAQ,EAAE,CAAC;QACb,CAAC,CAAC;IACJ,CAAC;IAEH,iBAAC;AAAD,CAAC;AAEM,SAAS,UAAU,CAAC,KAAkB,EAAE,IAAkB;IAC/D,IAAM,KAAK,GAAG,IAAI,UAAU,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;IAC1C,OAAO,KAAK,CAAC,QAAQ,EAAE,CAAC;AAC1B,CAAC","file":"fetch-xhr-hook.es5.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"fetchXhrHook\"] = factory();\n\telse\n\t\troot[\"fetchXhrHook\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.ts\");\n","import {EventType, RequestHandler, ResponseHandler, WindowEx} from \"./index.type\";\n\ndeclare let window: WindowEx;\n\nexport class Proxy {\n  private static _reqListeners: Array<RequestHandler<\"xhr\"|\"fetch\">> = [];\n  private static _resListeners: Array<ResponseHandler<\"xhr\"|\"fetch\">> = [];\n  private static _customXHR = window.XMLHttpRequest;\n  private static _customFetch = window.fetch;\n  public static readonly OriginalXHR = window.XMLHttpRequest;\n  /* Only IE does not implement `window.fetch`. Exclude from coverage counting. */\n  /* istanbul ignore next */\n  public static readonly OriginalFetch = (window.fetch || function fetch(){ return; }).bind(window);\n  \n  public static enable() {\n    window.XMLHttpRequest = Proxy._customXHR;\n    /* istanbul ignore else */\n    if(window.fetch){\n      window.fetch = Proxy._customFetch;\n    }\n  }\n  \n  public static disable() {\n    window.XMLHttpRequest = Proxy.OriginalXHR;\n    /* istanbul ignore else */\n    if(window.fetch && Proxy.OriginalFetch){\n      window.fetch = Proxy.OriginalFetch;\n    }\n  }\n  \n  public static isEnabled(){\n    return window.XMLHttpRequest === Proxy._customXHR;\n  }\n  \n  public static setXMLHttpRequest(m: typeof window[\"XMLHttpRequest\"]){\n    Proxy._customXHR = m;\n  }\n  \n  public static setFetch(m: typeof window[\"fetch\"]){\n    Proxy._customFetch = m;\n  }\n  \n  public static getRequestListeners() {\n    const listeners = Proxy._reqListeners;\n    return listeners.slice();\n  }\n  \n  public static getResponseListeners() {\n    const listeners = Proxy._resListeners;\n    return listeners.slice();\n  }\n  \n  public static onRequest(listener: RequestHandler<\"xhr\"|\"fetch\">, n?: number) {\n    const listeners = this._reqListeners;\n    if (listeners.indexOf(listener) > -1) {\n      return;\n    }\n  \n    if (typeof n === \"number\") {\n      listeners.splice(n, 0, listener);\n    } else {\n      listeners.push(listener);\n    }\n  }\n  \n  public static offRequest(listener: RequestHandler<\"xhr\"|\"fetch\">) {\n    this._removeEventListener(\"request\", listener);\n  }\n  \n  public static onResponse(listener: ResponseHandler<\"xhr\"|\"fetch\">, n?: number) {\n    const listeners = this._resListeners;\n    if (listeners.indexOf(listener) > -1) {\n      return;\n    }\n  \n    if (typeof n === \"number\") {\n      listeners.splice(n, 0, listener);\n    } else {\n      listeners.push(listener);\n    }\n  }\n  \n  public static offResponse(listener: ResponseHandler<\"xhr\"|\"fetch\">) {\n    this._removeEventListener(\"response\", listener);\n  }\n  \n  public static clearAll() {\n    Proxy.clearRequestHandler();\n    Proxy.clearResponseHandler();\n  }\n  \n  public static clearRequestHandler() {\n    this._reqListeners = [];\n  }\n  \n  public static clearResponseHandler() {\n    this._resListeners = [];\n  }\n  \n  private static _removeEventListener(type: EventType, listener: RequestHandler<\"xhr\"|\"fetch\"> | ResponseHandler<\"xhr\"|\"fetch\">) {\n    const listeners = type === \"request\" ? this._reqListeners : this._resListeners;\n    \n    for (let i = 0; i < listeners.length; i++) {\n      if (listeners[i] === listener) {\n        listeners.splice(i, 1);\n        return;\n      }\n    }\n  }\n}\n","const userAgent = typeof navigator !== \"undefined\" && navigator.userAgent ? navigator.userAgent : \"\";\n\n// If browser is not IE, IEVersion will be NaN\nexport const IEVersion = (() => {\n  let version = parseInt((/msie (\\d+)/.exec(userAgent.toLowerCase()) || [])[1], 10);\n  \n  /* istanbul ignore else */\n  if(isNaN(version)) {\n    version = parseInt((/trident\\/.*; rv:(\\d+)/.exec(userAgent.toLowerCase()) || [])[1], 10);\n    /* istanbul ignore else */\n    if(isNaN(version)){\n      return false;\n    }\n    /* istanbul ignore next */\n    return version;\n  }\n  \n  /* istanbul ignore next */\n  return version;\n})();\n\n/* istanbul ignore next */\nexport function isIE(op?: \"<\"|\"<=\"|\">\"|\">=\"|\"=\", version?: number){\n  if(IEVersion === false) return false;\n  else if(!version) return true;\n  else if(op === \"<\") return IEVersion < version;\n  else if(op === \"<=\") return IEVersion <= version;\n  else if(op === \">\") return IEVersion > version;\n  else if(op === \">=\") return IEVersion >= version;\n  else if(op === \"=\") return IEVersion === version;\n  return IEVersion === version;\n}\n\nexport const createEvent = (type: string): Event => {\n  try{\n    /* istanbul ignore else */\n    if(!isIE() && typeof Event !== \"undefined\"){\n      return new Event(type);\n    }\n    \n    // When browser is IE, `new Event()` will fail.\n    /* istanbul ignore next */\n    const ev = window.document.createEvent(\"Event\");\n    /* istanbul ignore next */\n    ev.initEvent(type);\n    /* istanbul ignore next */\n    return ev;\n  }\n  catch(e){\n    /* istanbul ignore next */\n    return {\n      type,\n    } as Event;\n  }\n};\n\nexport const toHeaderMap = (responseHeaders: string) => {\n  const headers = responseHeaders.trim().split(/[\\r\\n]+/)\n  \n  const map: {[name: string]: string} = {};\n  for(let i=0;i<headers.length;i++){\n    const line = headers[i];\n    const parts = line.split(\": \");\n    const name = parts.shift();\n    if(name){\n      const lowerName = name.toLowerCase();\n      map[lowerName] = parts.join(\": \");\n    }\n  }\n  \n  return map;\n}\n\nexport const toHeaderString = (headerMap: {[name: string]: string}) => {\n  const headers: string[] = [];\n  const keys = Object.keys(headerMap);\n  \n  for(let i=0;i<keys.length;i++){\n    const key = keys[i];\n    const name = key.toLowerCase();\n    const value = headerMap[key];\n    \n    headers.push(name + \": \" + value);\n  }\n  \n  return headers.join(\"\\r\\n\") + \"\\r\\n\";\n};\n\nexport const makeProgressEvent = (type: string, loaded: number, lengthComputable: boolean = false, total: number = 0) => {\n  const ev: ProgressEvent<XMLHttpRequestEventTarget> = {\n    ...createEvent(type),\n    type,\n    target: null,\n    loaded,\n    lengthComputable,\n    total,\n  };\n  \n  return ev;\n}\n","import {Proxy} from \"./Proxy\";\nimport {WindowEx} from \"./index.type\";\nimport {XHRProxy} from \"./modules/XMLHttpRequest\";\nimport {fetchProxy} from \"./modules/fetch\";\n\ndeclare let window: WindowEx;\n\nProxy.setXMLHttpRequest(XHRProxy);\nProxy.setFetch(fetchProxy);\nProxy.enable();\n\nexport default Proxy;\n","export class ResponseProxy {\n  private _response: Response;\n  private _body?: BodyInit | null;\n  private _init?: ResponseInit;\n  \n  public headers: Headers;\n  public ok: boolean;\n  public redirected: boolean;\n  public status: number;\n  public statusText: string;\n  public trailer: Promise<Headers>;\n  public type: ResponseType;\n  public url: string;\n  \n  public body: ReadableStream<Uint8Array> | null;\n  public bodyUsed: boolean;\n  \n  public constructor(body?: BodyInit | null, init?: ResponseInit) {\n    this._response = new Response(body, init);\n    this._body = body;\n    this._init = init;\n  \n    this.headers = new Headers(init ? init.headers : undefined);\n    this.ok = false;\n    this.redirected = false;\n    this.status = init && init.status ? init.status : 0;\n    this.statusText = init && init.statusText ? init.statusText : \"\";\n    this.trailer = this._response.trailer;\n    this.type = \"basic\";\n    this.url = \"\";\n    \n    this.body = this._response.body;\n    this.bodyUsed = this._response.bodyUsed;\n  }\n  \n  public static error(){\n    return Response.error();\n  }\n  \n  public static redirect(url: string, status?: number){\n    return Response.redirect(url, status);\n  }\n  \n  public clone(){\n    return new ResponseProxy(this._body, this._init);\n  }\n  \n  public arrayBuffer(){\n    return this._response.arrayBuffer();\n  }\n  \n  public blob(){\n    return this._response.blob();\n  }\n  \n  public formData(){\n    return this._response.formData();\n  }\n  \n  public json(){\n    return this._response.json();\n  }\n  \n  public text(){\n    return this._response.text();\n  }\n}\n","import {RequestCallback, ResponseCallback, XhrRequest, XhrResponse} from \"../index.type\";\nimport {createEvent, makeProgressEvent, toHeaderMap, toHeaderString, isIE} from \"../index.lib\";\nimport {Proxy} from \"../Proxy\";\n\nexport class XHRProxy implements XMLHttpRequest {\n  static readonly UNSENT: number = 0;\n  static readonly OPENED: number = 1;\n  static readonly HEADERS_RECEIVED: number = 2;\n  static readonly LOADING: number = 3;\n  static readonly DONE: number = 4;\n  \n  public readonly UNSENT: number = 0;\n  public readonly OPENED: number = 1;\n  public readonly HEADERS_RECEIVED: number = 2;\n  public readonly LOADING: number = 3;\n  public readonly DONE: number = 4;\n  \n  private _xhr = new Proxy.OriginalXHR();\n  private _listeners: {[type: string]: Array<(this: XMLHttpRequest, ev: Event|ProgressEvent<XMLHttpRequestEventTarget>) => unknown>} = {};\n  private _readyState: number = 0;\n  private _isAborted: boolean = false;\n  private _hasError: boolean|null = null;\n  private _transitioning: boolean|null = null;\n  private _request: XhrRequest = XHRProxy._createRequest(this._xhr);\n  private _response: XhrResponse = XHRProxy._createResponse();\n  private _responseText: string = \"\";\n  private _responseXML: Document | null = null;\n  \n  public readyState = 0;\n  public status = 0;\n  public statusText = \"\";\n  public timeout: number = 0;\n  public readonly upload = this._xhr.upload;\n  \n  public response: BodyInit|Document|null|undefined = \"\";\n  public responseType: XMLHttpRequestResponseType = \"\";\n  public responseURL: string = \"\";\n  public get responseText(): string {\n    if(this.responseType === \"text\" || this.responseType === \"\"){\n      return this._responseText;\n    }\n    /* istanbul ignore next */\n    else if(isIE(\">=\", 10)){\n      return this._responseText;\n    }\n    const e = new Error(\"responseText is only available if responseType is '' or 'text'.\");\n    e.name = \"InvalidStateError\";\n    throw e;\n  }\n  public get responseXML(): Document | null {\n    if(this.responseType === \"document\" || this.responseType === \"\"){\n      return this._responseXML;\n    }\n    /* istanbul ignore next */\n    else if(isIE(\">=\", 10)){\n      return this._responseXML;\n    }\n    const e = new Error(\"responseXML is only available if responseType is '' or 'document'.\");\n    e.name = \"InvalidStateError\";\n    throw e;\n  }\n  public withCredentials: boolean = false;\n  \n  public onreadystatechange: ((this: XMLHttpRequest, ev: Event) => unknown) | null = null;\n  public onabort: ((this: XMLHttpRequest, ev: Event) => unknown) | null = null;\n  public onerror: ((this: XMLHttpRequest, ev: Event) => unknown) | null = null;\n  public onloadstart: ((this: XMLHttpRequest, ev: Event) => unknown) | null = null;\n  public onload: ((this: XMLHttpRequest, ev: Event) => unknown) | null = null;\n  public onloadend: ((this: XMLHttpRequest, ev: Event) => unknown) | null = null;\n  public ontimeout: ((this: XMLHttpRequest, ev: Event) => unknown) | null = null;\n  public onprogress: ((this: XMLHttpRequest, ev: Event) => unknown) | null = null;\n  \n  constructor() {\n    this._init();\n  }\n  \n  private _init(){\n    this._onError = this._onError.bind(this);\n    this._createRequestCallback = this._createRequestCallback.bind(this);\n  \n    const addEventListener = <K extends keyof XMLHttpRequestEventMap>(type: K) => {\n      this.addEventListener(type, this._onError);\n    }\n    addEventListener(\"error\");\n    addEventListener(\"timeout\");\n    addEventListener(\"abort\");\n    \n    this._xhr.onreadystatechange = () => {\n      // According to https://xhr.spec.whatwg.org/#the-abort()-method\n      // onreadystatechange should not be called,\n      // but some major browsers seems to call it actually.\n      /*\n      if(this._isAborted){\n        return;\n      }\n      */\n  \n      const realReadyState = this._xhr.readyState;\n      \n      if(realReadyState === this.HEADERS_RECEIVED){\n        /* istanbul ignore if */\n        if(isIE(\"<=\", 9) && /* istanbul ignore next */ this._request.async === false){\n          // For synchronous request in IE <= 9, it throws Error when accessing xhr header if readyState is less than LOADING.\n          // this._loadHeaderFromXHRToVirtualResponse();\n        }\n        else{\n          this._loadHeaderFromXHRToVirtualResponse();\n        }\n      }\n      else if(realReadyState === this.LOADING){\n        this._loadHeaderFromXHRToVirtualResponse();\n      }\n      else if(realReadyState === this.DONE){\n        this._transitioning = false;\n        this._loadHeaderFromXHRToVirtualResponse();\n        this._loadBodyFromXHRToVirtualResponse();\n      }\n      \n      this._runUntil(realReadyState);\n    };\n  }\n  \n  public addEventListener<K extends keyof XMLHttpRequestEventMap>(\n    type: K,\n    listener: (this: XMLHttpRequest, ev: Event|ProgressEvent<XMLHttpRequestEventTarget>) => unknown,\n    options?: boolean | AddEventListenerOptions\n  ){\n    if(!this._listeners[type]){\n      this._listeners[type] = [];\n    }\n    \n    this._listeners[type].push(listener);\n  }\n  \n  public removeEventListener<K extends keyof XMLHttpRequestEventMap>(\n    type: K,\n    listener: (this: XMLHttpRequest, ev: Event|ProgressEvent<XMLHttpRequestEventTarget>) => any,\n    options?: boolean | EventListenerOptions\n  ){\n    if(!this._listeners[type]){\n      return;\n    }\n    \n    const index = this._listeners[type].indexOf(listener);\n    if(index < 0){\n      return;\n    }\n    \n    this._listeners[type].splice(index, 1);\n  }\n  \n  public dispatchEvent(event: Event|ProgressEvent<XMLHttpRequestEventTarget>){\n    if(typeof event !== \"object\"){\n      throw new TypeError(\"EventTarget.dispatchEvent: Argument 1 is not an object\");\n    }\n    \n    const onHandlerPropName = \"on\" + event.type;\n    if(onHandlerPropName === \"onabort\"\n      || onHandlerPropName === \"onerror\"\n      || onHandlerPropName === \"onload\"\n      || onHandlerPropName === \"onloadend\"\n      || onHandlerPropName === \"onloadstart\"\n      || onHandlerPropName === \"onprogress\"\n      || onHandlerPropName === \"ontimeout\"\n    ){\n      const handler = this[onHandlerPropName];\n      if(handler){\n        handler.call(this, event as ProgressEvent<XMLHttpRequestEventTarget>);\n      }\n    }\n    else if(onHandlerPropName === \"onreadystatechange\"){\n      const handler = this[onHandlerPropName];\n      if(handler){\n        handler.call(this, event as Event);\n      }\n    }\n    \n    const listeners = this._listeners[event.type];\n    if(!listeners){\n      return true;\n    }\n    \n    for(let i=0;i<listeners.length;i++){\n      const l = listeners[i];\n      l.call(this, event);\n    }\n    return true;\n  }\n  \n  public overrideMimeType(mime: string) {\n    return this._xhr.overrideMimeType.call(this._xhr, mime);\n  }\n  \n  public open(method: string, url: string, async?: boolean, username?: string|null, password?: string|null){\n    if(arguments.length < 2){\n      throw new TypeError(\"XMLHttpRequest.open: \" + arguments.length + \" is not a valid argument count for any overload\");\n    }\n    \n    this._readyState = 0;\n    this._hasError = false;\n    this._isAborted = false;\n    this._transitioning = false;\n    \n    this._request = {\n      ...XHRProxy._createRequest(this._xhr),\n      headers: {},\n      method,\n      url,\n      async: async !== false,\n      username,\n      password,\n    };\n    \n    this._response = {\n      ...XHRProxy._createResponse(),\n      headers: {},\n    };\n    \n    this._runUntil(this.OPENED);\n  }\n  \n  public send(body?: Document | BodyInit | null) {\n    if(this._readyState !== this.OPENED){\n      throw new DOMException(\"XMLHttpRequest state must be OPENED\");\n    }\n  \n    this._setupVirtualRequestForSending(body);\n    this._syncEventListenersToXHR();\n    \n    let isDispatchXHRSendCalled = false;\n  \n    const dispatchXHRSend = () => {\n      isDispatchXHRSendCalled = true;\n      \n      // When requestCallback is used, readystate is automatically move forward to 'DONE'\n      // and produce dummy response.\n      if(this._readyState === this.DONE){\n        return;\n      }\n    \n      this._transitioning = true;\n      \n      const async = this._request.async !== false;\n    \n      this._xhr.open(\n        this._request.method,\n        this._request.url,\n        async,\n        this._request.username,\n        this._request.password\n      );\n    \n      if(async){\n        this._xhr.responseType = this.responseType;\n        this._xhr.timeout = this.timeout;\n      }\n      this._xhr.withCredentials = this.withCredentials;\n    \n      this.dispatchEvent(makeProgressEvent(\"loadstart\", 0));\n    \n      const headerMap = this._request.headers;\n      const headerNames = headerMap ? Object.keys(headerMap) : [];\n      for(let i=0;i<headerNames.length;i++){\n        const headerName = headerNames[i];\n        const headerValue = headerMap[headerName];\n        this._xhr.setRequestHeader(headerName, headerValue);\n      }\n    \n      this._xhr.send(this._request.body);\n    };\n  \n    const listeners = Proxy.getRequestListeners();\n    let listenerPointer = 0;\n  \n    const executeNextListener = (): unknown => {\n      try{\n        if(listenerPointer >= listeners.length){\n          return dispatchXHRSend();\n        }\n      \n        const l = listeners[listenerPointer];\n      \n        // l: (request, callback) => unknown\n        if(l.length >= 2){\n          const userCallback = this._createRequestCallback(() => {\n            listenerPointer++;\n            executeNextListener();\n          });\n        \n          l.call(this, this._request, userCallback as RequestCallback<\"xhr\"|\"fetch\">);\n          return;\n        }\n      \n        // l: (request) => unknown\n        l.call(this, this._request);\n      \n        listenerPointer++;\n        executeNextListener();\n      }\n      catch(e){\n        console.warn(\"XMLHttpRequest: Exception in request handler\", e);\n      \n        if(!isDispatchXHRSendCalled){\n          listenerPointer++;\n          executeNextListener();\n        }\n      }\n    };\n  \n    executeNextListener();\n  }\n  \n  public setRequestHeader(name: string, value: string) {\n    if(this.readyState !== this.OPENED){\n      throw new DOMException(\"XMLHttpRequest state must be OPENED\");\n    }\n    \n    if(!this._request.headers){\n      this._request.headers = {};\n    }\n    \n    const lowerName = name.toLowerCase();\n    if(this._request.headers[lowerName]){\n      value = this._request.headers[lowerName] + \", \" + value;\n    }\n    \n    this._request.headers[lowerName] = value;\n  }\n  \n  public getResponseHeader(name: string): string | null {\n    const lowerHeaderName = name.toLowerCase();\n    if(this.readyState < this.HEADERS_RECEIVED || !(lowerHeaderName in this._response.headers)){\n      // IE <= 9 throws Error when readyState is UNSENT\n      /* istanbul ignore next */\n      if(isIE(\"<=\", 9)){\n        if(this.readyState < this.OPENED){\n          throw new Error();\n        }\n        return \"\";\n      }\n      return null;\n    }\n    return this._response.headers[lowerHeaderName];\n  }\n  \n  public getAllResponseHeaders(): string {\n    if(this.readyState < this.HEADERS_RECEIVED){\n      // According to MDN, getAllResponseHeaders returns null if headers are not yet received.\n      // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/getAllResponseHeaders\n      // But lib.dom.d.ts asserts it always returns string.\n      // Don't know which is correct.\n      \n      // IE <= 9 throws Error when readyState is UNSENT\n      /* istanbul ignore next */\n      if(isIE(\"<=\", 9) && this.readyState < this.OPENED){\n        throw new Error();\n      }\n      return \"\";\n    }\n    return toHeaderString(this._response.headers);\n  }\n  \n  public abort() {\n    // According to https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/Synchronous_and_Asynchronous_Requests#Synchronous_request ,\n    // it should throw an Error on abort() called when using synchronous request.\n    // However, it actually does not in some major browser.\n    /*\n    if(this._request.async === false){\n      throw new Error(\"Invalid access error\");\n    }\n   */\n    \n    this._isAborted = true;\n    this.status = 0;\n    this.readyState = this.UNSENT;\n    this._readyState = this.UNSENT;\n    \n    if(this._transitioning){\n      this._xhr.abort();\n    }\n    else{\n      this.dispatchEvent(makeProgressEvent(\"abort\", 0));\n    }\n    \n    this._transitioning = false;\n  }\n  \n  private static _createRequest(xhr: XMLHttpRequest): XhrRequest {\n    return {\n      ajaxType: \"xhr\" as const,\n      headers: {},\n      method: \"GET\",\n      url: \"\",\n      async: true,\n      timeout: 0,\n      upload: xhr.upload,\n    };\n  }\n  \n  private static _createResponse(){\n    return {\n      ajaxType: \"xhr\" as const,\n      status: 0,\n      statusText: \"\",\n      finalUrl: \"\",\n      responseType: \"\" as const,\n      headers: {},\n    };\n  }\n  \n  private _setupVirtualRequestForSending(body?: Document | BodyInit | null){\n    this._request.responseType = this.responseType;\n    this._request.timeout = this.timeout;\n    this._request.withCredentials = this.withCredentials;\n    this._request.body = body;\n    this._xhr.onabort = typeof(this.onabort) === \"function\" ? this.onabort.bind(this) : null;\n    this._xhr.onerror = typeof(this.onerror) === \"function\" ? this.onerror.bind(this) : null;\n    this._xhr.ontimeout = typeof(this.ontimeout) === \"function\" ? this.ontimeout.bind(this) : null;\n    this._xhr.onprogress = typeof(this.onprogress) === \"function\" ? this.onprogress.bind(this) : null;\n  }\n  \n  private _syncEventListenersToXHR(){\n    const addEventListeners = <K extends keyof XMLHttpRequestEventMap>(type: K) => {\n      const localListeners = this._listeners[type];\n      if(!localListeners || localListeners.length < 1){\n        return;\n      }\n    \n      for(let i=0;i<localListeners.length;i++){\n        this._xhr.addEventListener(type, localListeners[i].bind(this));\n      }\n    };\n  \n    addEventListeners(\"abort\");\n    addEventListeners(\"error\");\n    addEventListeners(\"timeout\");\n    addEventListeners(\"progress\");\n  }\n  \n  private _createRequestCallback(onCalled: () => unknown) : RequestCallback<\"xhr\"> {\n    type RequestCallbackOnlyWithDefaultFunc = {\n      (dummyResponse: XhrResponse): unknown;\n      moveToHeaderReceived?: (dummyResponse: XhrResponse) => void;\n      moveToLoading?: (dummyResponse: XhrResponse) => void;\n    };\n    \n    const cb: RequestCallbackOnlyWithDefaultFunc = (response: XhrResponse) => {\n      if(!response || typeof response !== \"object\"){\n        onCalled();\n        return;\n      }\n      \n      this.dispatchEvent(makeProgressEvent(\"loadstart\", 0));\n  \n      this._response = {\n        ...this._response,\n        ...response,\n      };\n  \n      this._runUntil(this.DONE);\n  \n      onCalled();\n    };\n    \n    const moveToHeaderReceived = (response: XhrResponse) => {\n      if(this.readyState >= this.HEADERS_RECEIVED){\n        return;\n      }\n      this._response = {\n        ...this._response,\n        ...response,\n      };\n      this._runUntil(this.HEADERS_RECEIVED);\n    };\n    \n    const moveToLoading = (response: XhrResponse) => {\n      if(this.readyState >= this.LOADING){\n        return;\n      }\n      this._response = {\n        ...this._response,\n        ...response,\n      };\n      this._runUntil(this.LOADING);\n    };\n    \n    cb.moveToHeaderReceived = moveToHeaderReceived;\n    cb.moveToLoading = moveToLoading;\n    \n    return cb as RequestCallback<\"xhr\">;\n  }\n  \n  private _createResponseCallback(onCalled: () => unknown) : ResponseCallback<\"xhr\"> {\n    return (response: XhrResponse) => {\n      if(!response || typeof response !== \"object\"){\n        onCalled();\n        return;\n      }\n      \n      this._response = {\n        ...this._response,\n        ...response,\n      };\n      \n      onCalled();\n    };\n  }\n  \n  private _loadHeaderFromXHRToVirtualResponse(){\n    this._response.status = this._xhr.status;\n    if(!this._isAborted){\n      this._response.statusText = this._xhr.statusText;\n    }\n    else{\n      return;\n    }\n    \n    const responseHeaders = this._xhr.getAllResponseHeaders();\n    const headerMap = toHeaderMap(responseHeaders);\n  \n    const keys = Object.keys(headerMap);\n    for(let i=0;i<keys.length;i++){\n      const key = keys[i];\n      const value = headerMap[key];\n      if(!this._response.headers[key]){\n        this._response.headers[key] = value;\n      }\n    }\n  }\n  \n  private _loadBodyFromXHRToVirtualResponse(){\n    if(!this._xhr.responseType){\n      this._response.responseText = this._xhr.responseText;\n      this._response.responseXML = this._xhr.responseXML;\n      this._response.response = this._xhr.responseText;\n    }\n    else if(this._xhr.responseType === \"text\"){\n      this._response.responseText = this._xhr.responseText;\n      this._response.response = this._xhr.responseText;\n    }\n    else if(this._xhr.responseType === \"document\"){\n      this._response.responseXML = this._xhr.responseXML;\n      this._response.response = this._xhr.responseXML;\n    }\n    else{\n      this._response.response = this._xhr.response;\n    }\n    \n    if(\"responseURL\" in this._xhr){\n      this._response.responseURL = this._xhr.responseURL;\n    }\n  }\n  \n  private _syncHeaderFromVirtualResponse(){\n    this.status = this._response.status;\n    this.statusText = this._response.statusText;\n    // Response headers will be requested via getResponseHeader/getAllResponseHeaders\n    // which get header values directly from this._response.\n  }\n  \n  private _syncBodyFromVirtualResponse(){\n    if(\"responseText\" in this._response){\n      this._responseText = this._response.responseText || \"\";\n    }\n    if(\"responseXML\" in this._response){\n      this._responseXML = this._response.responseXML || null;\n    }\n    if(\"body\" in this._response){\n      this.response = this._response.body || null;\n    }\n    if(\"response\" in this._response){\n      this.response = this._response.response;\n    }\n    if(\"responseURL\" in this._response){\n      this.responseURL = this._response.responseURL || \"\";\n    }\n  }\n  \n  private _onError(){\n    this._hasError = true;\n    this._readyState = this.UNSENT;\n    this.readyState = this.UNSENT;\n    this.status = 0;\n  }\n  \n  private _triggerStateAction(){\n    const readyStateChangeEvent = createEvent(\"readystatechange\");\n    \n    if(this._readyState === this.OPENED){\n      this.dispatchEvent(readyStateChangeEvent);\n    }\n    else if(this._readyState === this.HEADERS_RECEIVED){\n      this._syncHeaderFromVirtualResponse();\n      this.dispatchEvent(readyStateChangeEvent);\n    }\n    else if(this._readyState === this.LOADING){\n      this._syncHeaderFromVirtualResponse();\n      this.dispatchEvent(readyStateChangeEvent);\n    }\n    else if(this._readyState === this.DONE){\n      this._syncHeaderFromVirtualResponse();\n      this._syncBodyFromVirtualResponse();\n      \n      let isReturnResponseCalled = false;\n      \n      const returnResponse = () => {\n        isReturnResponseCalled = true;\n        \n        // Re-sync for a case that this._request/this._response is modified in callback\n        this._syncHeaderFromVirtualResponse();\n        this._syncBodyFromVirtualResponse();\n  \n        this.dispatchEvent(readyStateChangeEvent);\n  \n        const emitLoadEvent = () => {\n          if(!this._hasError){\n            this.dispatchEvent(makeProgressEvent(\"load\", 0));\n          }\n          this.dispatchEvent(makeProgressEvent(\"loadend\", 0));\n        };\n  \n        if(this._request.async === false){\n          emitLoadEvent();\n        }\n        else{\n          window.setTimeout(emitLoadEvent, 0);\n        }\n      };\n  \n      const listeners = Proxy.getResponseListeners();\n      let listenerPointer = 0;\n  \n      const executeNextListener = (): unknown => {\n        try{\n          if(listenerPointer >= listeners.length){\n            return returnResponse();\n          }\n      \n          const l = listeners[listenerPointer];\n      \n          // l: (request, response, callback) => unknown\n          if(l.length >= 3){\n            const userCallback = this._createResponseCallback(() => {\n              listenerPointer++;\n              executeNextListener();\n            });\n        \n            l.call(this, this._request, this._response, userCallback);\n            return;\n          }\n      \n          // l: (request, response) => unknown\n          l.call(this, this._request, this._response);\n      \n          listenerPointer++;\n          executeNextListener();\n        }\n        catch(e){\n          console.warn(\"XMLHttpRequest: Exception in response handler\", e);\n      \n          if(!isReturnResponseCalled){\n            listenerPointer++;\n            executeNextListener();\n          }\n        }\n      };\n  \n      executeNextListener();\n    }\n  }\n  \n  private _runUntil(state: number){\n    while(this._readyState < state && this._readyState < this.DONE){\n      this._readyState++;\n      this.readyState = this._readyState;\n    \n      this._triggerStateAction();\n    }\n  }\n}\n","import {Proxy} from \"../Proxy\";\nimport {FetchRequest, FetchResponse, RequestCallback, ResponseCallback, TResponse} from \"../index.type\";\nimport {ResponseProxy} from \"./Response\";\n\nclass FetchProxy {\n  private _request: FetchRequest;\n  private _response: FetchResponse;\n  private _input?: RequestInfo;\n  private _init?: RequestInit;\n  \n  public constructor(input: RequestInfo, init?: RequestInit) {\n    this._input = input;\n    this._init = init;\n  \n    this.dispatch = this.dispatch.bind(this);\n    this._onResponse = this._onResponse.bind(this);\n    this._createRequestCallback = this._createRequestCallback.bind(this);\n    this._createResponseCallback = this._createResponseCallback.bind(this);\n    \n    this._request = FetchProxy._createRequest(input, init);\n    this._response = FetchProxy._createResponse();\n  }\n  \n  public dispatch(): Promise<Response> {\n    return new Promise((resolve, reject) => {\n      const originalResponse = this._response;\n      let isDispatchFetchCalled = false;\n      \n      const dispatchFetch = () => {\n        isDispatchFetchCalled = true;\n        \n        if(originalResponse !== this._response){\n          this._onResponse().then((response) => {\n            resolve(response);\n          });\n          return;\n        }\n        \n        Proxy.OriginalFetch(this._request.url, this._request).then(response => {\n          const headers: Record<string, string> = {};\n          for(const key of response.headers.keys()){\n            const value = response.headers.get(key)\n            if(value){\n              headers[key] = value;\n            }\n          }\n          \n          this._response = {\n            ajaxType: \"fetch\",\n            status: response.status,\n            statusText: response.statusText,\n            headers,\n            ok: response.ok,\n            redirected: response.redirected,\n            type: response.type,\n            url: response.url,\n            body: response.body,\n          };\n          \n          this._onResponse().then(r => {\n            resolve(r);\n          });\n        });\n      };\n  \n      const requestListeners = Proxy.getRequestListeners();\n      let listenerPointer = 0;\n  \n      const executeNextListener = (): unknown => {\n        try{\n          if(listenerPointer >= requestListeners.length){\n            return dispatchFetch();\n          }\n      \n          const l = requestListeners[listenerPointer];\n      \n          // l: (request, callback) => unknown\n          if(l.length >= 2){\n            const userCallback = this._createRequestCallback(() => {\n              listenerPointer++;\n              executeNextListener();\n            });\n        \n            l.call({}, this._request, userCallback as RequestCallback<\"xhr\"|\"fetch\">);\n            return;\n          }\n      \n          // l: (request) => unknown\n          l.call({}, this._request);\n      \n          listenerPointer++;\n          executeNextListener();\n        }\n        catch(e){\n          console.warn(\"XMLHttpRequest: Exception in request handler\", e);\n      \n          if(!isDispatchFetchCalled){\n            listenerPointer++;\n            executeNextListener();\n          }\n        }\n      };\n  \n      executeNextListener();\n    });\n  }\n  \n  private _onResponse(){\n    return new Promise<Response>((resolve => {\n      let isReturnResponseCalled = false;\n  \n      const returnResponse = () => {\n        isReturnResponseCalled = true;\n        const res = new ResponseProxy(this._response.body, this._response);\n        res.url = this._response.url;\n        res.type = this._response.type;\n        res.redirected = this._response.redirected;\n        res.ok = this._response.ok;\n        resolve(res);\n      };\n  \n      const responseListeners = Proxy.getResponseListeners();\n      let listenerPointer = 0;\n  \n      const executeNextListener = (): unknown => {\n        try{\n          if(listenerPointer >= responseListeners.length){\n            return returnResponse();\n          }\n      \n          const l = responseListeners[listenerPointer];\n      \n          // l: (request, response, callback) => unknown\n          if(l.length >= 3){\n            const userCallback = this._createResponseCallback(() => {\n              listenerPointer++;\n              executeNextListener();\n            });\n        \n            l.call({}, this._request, this._response, userCallback);\n            return;\n          }\n      \n          // l: (request, response) => unknown\n          l.call({}, this._request, this._response);\n      \n          listenerPointer++;\n          executeNextListener();\n        }\n        catch(e){\n          console.warn(\"XMLHttpRequest: Exception in request handler\", e);\n      \n          if(!isReturnResponseCalled){\n            listenerPointer++;\n            executeNextListener();\n          }\n        }\n      };\n  \n      executeNextListener();\n    }));\n  }\n  \n  private static _createRequest(input: RequestInfo, init?: RequestInit): FetchRequest {\n    if(typeof input === \"string\"){\n      const req = {\n        ...(init||{}),\n        ajaxType: \"fetch\",\n        headers: {},\n        url: input,\n      } as FetchRequest;\n      \n      if(init && init.headers){\n        const headers = init.headers instanceof Headers ? init.headers : new Headers(init.headers);\n  \n        /**\n         * Webpack's es5 output for `for-of` loop over iterable does not work as expected as of 2020/08/08.\n         * \n         * for(const pair of headers.entries()){\n         *   ...\n         * }\n         * \n         * will be converted to\n         * \n         * for (var _i = 0, _a = headers.entries(); _i < _a.length; _i++) {\n         *   ...\n         * }\n         * \n         * Since headers.entries() returns not an array but iterable, `_a.length` is undefined.\n         * So the loop never run.\n         * As a work around, I convert iterable to an array as below.\n         */\n        const entries = Array.from(headers.entries());\n        for(let i=0;i<entries.length;i++){\n          const pair = entries[i];\n          const key = pair[0];\n          const value = pair[1];\n          if(value){\n            req.headers[key] = value;\n          }\n        }\n      }\n      \n      return req;\n    }\n    else{\n      const headers = input.headers || (init && init.headers ? init.headers : null);\n      \n      const req = {\n        ...(init||{}),\n        ajaxType: \"fetch\",\n        method: input.method,\n        url: input.url,\n        timeout: 0,\n        headers: {},\n        // input.body may be `undefined` since major browsers does not support it as of 2020/08/06.\n        // https://developer.mozilla.org/en-US/docs/Web/API/Request/Request#bcd:api.Request.Request\n        body: input.body,\n        cache: input.cache,\n        credentials: input.credentials,\n        integrity: input.integrity,\n        keepalive: input.keepalive,\n        mode: input.mode,\n        redirect: input.redirect,\n        referrer: input.referrer,\n        referrerPolicy: input.referrerPolicy,\n        signal: input.signal,\n      } as FetchRequest;\n  \n      if(headers){\n        const entries = Array.from(headers.entries());\n        for(let i=0;i<entries.length;i++){\n          const pair = entries[i];\n          const key = pair[0];\n          const value = pair[1];\n          if(value){\n            req.headers[key] = value;\n          }\n        }\n      }\n      \n      return req;\n    }\n  }\n  \n  private static _createResponse(): FetchResponse {\n    return {\n      ajaxType: \"fetch\",\n      status: 0,\n      statusText: \"\",\n      headers: {},\n      ok: true,\n      redirected: false,\n      type: \"basic\",\n      url: \"\",\n      body: null,\n    };\n  }\n  \n  private _createRequestCallback(onCalled: () => unknown): RequestCallback<\"fetch\"> {\n    type RequestCallbackOnlyWithDefaultFunc = {\n      (dummyResponse: FetchResponse): unknown;\n      moveToHeaderReceived?: (dummyResponse: TResponse<\"fetch\">) => void;\n      moveToLoading?: (dummyResponse: TResponse<\"fetch\">) => void;\n    };\n  \n    const cb: RequestCallbackOnlyWithDefaultFunc = (response: FetchResponse) => {\n      if(!response || typeof response !== \"object\"){\n        onCalled();\n        return;\n      }\n  \n      this._response = response;\n      onCalled();\n    };\n    \n    cb.moveToHeaderReceived = () => { return; };\n    cb.moveToLoading = () => { return; };\n    \n    return cb as RequestCallback<\"fetch\">;\n  }\n  \n  private _createResponseCallback(onCalled: () => unknown) : ResponseCallback<\"fetch\"> {\n    return (response: FetchResponse) => {\n      if(!response || typeof response !== \"object\"){\n        onCalled();\n        return;\n      }\n      \n      this._response = response;\n      \n      onCalled();\n    };\n  }\n  \n}\n\nexport function fetchProxy(input: RequestInfo, init?: RequestInit): Promise<Response> {\n  const fetch = new FetchProxy(input, init);\n  return fetch.dispatch();\n}"],"sourceRoot":""}